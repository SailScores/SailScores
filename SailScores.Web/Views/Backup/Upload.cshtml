@model SailScores.Web.Controllers.BackupUploadViewModel

@{
    ViewData["Title"] = "Upload Backup";
    Layout = "_ClubLayout";
}

<h2>Restore from Backup</h2>
<p class="lead">Upload a backup file to restore data to @Model.ClubName.</p>

<hr />

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["Error"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="card">
    <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-upload me-2"></i>Select Backup File</h5>
    </div>
    <div class="card-body">
        <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <strong>Warning:</strong> Restoring a backup will <strong>replace all existing data</strong> in @Model.ClubName.
            This action cannot be undone. Consider downloading a backup of the current data first.
        </div>

        <form asp-action="Upload" method="post" enctype="multipart/form-data">
            <div class="mb-3">
                <label for="backupFile" class="form-label">Backup File</label>
                <input type="file" class="form-control" id="backupFile" name="backupFile" 
                       accept=".gz,.json" required />
                <div class="form-text">Select a .json.gz backup file previously downloaded from SailScores.</div>
            </div>

            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="preserveClubSettings" 
                           name="preserveClubSettings" value="true" checked />
                    <label class="form-check-label" for="preserveClubSettings">
                        Preserve current club name, initials, and URL
                    </label>
                </div>
                <div class="form-text">
                    When checked, only the data will be restored. The club identity (name, initials, URL) will remain unchanged.
                    Uncheck to also restore the club settings from the backup.
                </div>
            </div>

            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="confirmRestore" required />
                    <label class="form-check-label" for="confirmRestore">
                        I understand this will permanently delete all existing data in @Model.ClubName and replace it with the backup data.
                    </label>
                </div>
            </div>

            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-danger">
                    <i class="fas fa-upload me-2"></i>Restore Backup
                </button>
                <a asp-action="Index" class="btn btn-outline-secondary">
                    <i class="fas fa-times me-2"></i>Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<div class="mt-4">
    <a asp-action="Index" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-left me-2"></i>Back to Backup &amp; Restore
    </a>
</div>
