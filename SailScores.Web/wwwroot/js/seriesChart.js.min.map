{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./wwwroot/js/seriesChart.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","chartOverallHeight","charts","document","getElementsByClassName","length","drawChart","dataset","seriesId","id","elementId","minDate","maxDate","dataPath","getDate","result","allData","thisRace","races","find","raceId","racesThisDate","filter","date","order","findIndex","Date","getTime","getY","maxScore","Math","max","entries","e","map","seriesPoints","minScore","min","ratio","isNaN","responsivefy","svg","container","d3","select","node","parentNode","width","parseInt","style","height","aspect","resize","targetWidth","attr","round","window","on","json","then","data","dates","apply","setDate","xScale","scaleTime","domain","range","chartOverallWidth","color","scaleOrdinal","schemeDark2","competitors","svgElement","onMouseOver","compId","competitorId","selectAll","onMouseOut","tooltipGroup","legend","enter","append","legendWidth","legendLineHeight","text","xAxis","axisTop","scale","language","substring","tickFormat","lineData","line","x","y","remove","shortName","racePlace"],"mappings":"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","file":"seriesChart.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","\r\n(function () {\r\n\r\n    var chartOverallWidth = 960;\r\n    var chartOverallHeight = 600;\r\n    var margin = 30;\r\n    var legendWidth = 150;\r\n    var legendLineHeight = 16;\r\n    var legendMargin = 2;\r\n\r\n\r\n    var charts = document.getElementsByClassName(\"results-chart\");\r\n    for (var i = 0; i < charts.length; i++) {\r\n        drawChart(charts[i].dataset.seriesId, \"#\"+charts[i].id)\r\n    }\r\n\r\n    function drawChart(seriesId, elementId) {\r\n        //var chartElementId = elementId;\r\n\r\n        var minDate;\r\n        var maxDate;\r\n\r\n        var dataPath = \"/series/chart?seriesId=\" + seriesId;\r\n        if (typeof (d3) != \"undefined\" && d3 != null) {\r\n            d3.json(dataPath).then(processChartData);\r\n        }\r\n\r\n\r\n        function getDate(result, allData) {\r\n            var thisRace = allData.races.find(r => r.id === result.raceId);\r\n            var racesThisDate = allData.races.filter(r => r.date === thisRace.date);\r\n\r\n            var order = racesThisDate.findIndex(r => r.id === thisRace.id) + 1;\r\n\r\n            return new Date(new Date(thisRace.date).getTime()\r\n                + (order * 24 * 60 * 60 * 1000 / (racesThisDate.length + 1)));\r\n        }\r\n\r\n        function getY(result, allData) {\r\n            var maxScore = Math.max(...allData.entries\r\n                .filter(e => e.raceId === result.raceId)\r\n                .map(e => e.seriesPoints));\r\n            var minScore = Math.min(...allData.entries\r\n                .filter(e => e.raceId === result.raceId\r\n                    && e.seriesPoints !== 0)\r\n                .map(e => e.seriesPoints));\r\n            var ratio = (result.seriesPoints - minScore) / (maxScore - minScore);\r\n            if (isNaN(ratio)) {\r\n                ratio = 0;\r\n            }\r\n            if (result.seriesPoints === 0) {\r\n                ratio = 1;\r\n            }\r\n            return margin + (ratio * (chartOverallHeight - margin - margin));\r\n        }\r\n\r\n        function responsivefy(svg) {\r\n            // get container + svg aspect ratio\r\n            var container = d3.select(svg.node().parentNode),\r\n                width = parseInt(svg.style(\"width\")),\r\n                height = parseInt(svg.style(\"height\")),\r\n                aspect = width / height;\r\n\r\n            // add viewBox and preserveAspectRatio properties,\r\n            // and call resize so that svg resizes on inital page load\r\n            svg.attr(\"viewBox\", \"0 0 \" + width + \" \" + height)\r\n                .attr(\"preserveAspectRatio\", \"xMinYMid\")\r\n                .call(resize);\r\n\r\n            // to register multiple listeners for same event type, \r\n            // you need to add namespace, i.e., 'click.foo'\r\n            // necessary if you call invoke this function for multiple svgs\r\n            // api docs: https://github.com/mbostock/d3/wiki/Selections#on\r\n            d3.select(window).on(\"resize.\" + container.attr(\"id\"), resize);\r\n\r\n            // get width of container and resize svg to fit it\r\n            function resize() {\r\n                var targetWidth = parseInt(container.style(\"width\"));\r\n                if (targetWidth <= 100) {// assume percent\r\n                    targetWidth = width;\r\n                }\r\n                svg.attr(\"width\", targetWidth);\r\n                svg.attr(\"height\", Math.round(targetWidth / aspect));\r\n            }\r\n        }\r\n\r\n        function getCompName(id, competitors) {\r\n            return competitors.find(c => c.id === id).name;\r\n        }\r\n\r\n        function processChartData(data) {\r\n            if (data === null) {\r\n                return;\r\n            }\r\n            var dates = data.races.map(r => new Date(r.date));\r\n            minDate = new Date(Math.min.apply(null, dates));\r\n            maxDate = new Date(Math.max.apply(null, dates));\r\n            maxDate.setDate(maxDate.getDate() + 1);\r\n\r\n            var xScale = d3.scaleTime()\r\n                .domain([minDate, maxDate])\r\n                .range([margin, chartOverallWidth - margin - legendWidth]);\r\n            var color = d3.scaleOrdinal(d3.schemeDark2);\r\n\r\n            chartOverallHeight = data.competitors.length * legendLineHeight + (2 * margin);\r\n\r\n            var svgElement = d3.select(elementId)\r\n                .attr(\"width\", chartOverallWidth)\r\n                .attr(\"height\", chartOverallHeight)\r\n                .call(responsivefy);\r\n\r\n            function getRaceName(raceId) {\r\n                return data.races.find(r => r.id === raceId).shortName;\r\n            }\r\n\r\n            function onMouseOver(d) {\r\n                var compId = d.competitorId || d.id;\r\n                svgElement\r\n                    .selectAll(\"path.compLine\")\r\n                    .attr(\"opacity\", .4);\r\n                svgElement\r\n                    .selectAll(\"path[data-compId='\" + compId + \"']\")\r\n                    .attr(\"stroke-width\", 4)\r\n                    .attr(\"opacity\", 1);\r\n                svgElement\r\n                    .selectAll(\"g.legendEntry\")\r\n                    .attr(\"opacity\", .4);\r\n                svgElement\r\n                    .selectAll(\"g.legendEntry[data-compId='\" + compId + \"']\")\r\n                    .attr(\"opacity\", 1);\r\n                svgElement\r\n                    .selectAll(\"g.legendEntry[data-compId='\" + compId + \"'] rect\")\r\n                    .attr(\"stroke\", (c) => color(c.id));\r\n                svgElement.selectAll(\"circle\")\r\n                    .attr(\"opacity\", .4);\r\n                svgElement\r\n                    .selectAll(\"circle[data-compId='\" + compId + \"']\")\r\n                    .attr(\"opacity\", 1);\r\n\r\n            }\r\n            function onMouseOverRace(d) {\r\n                tooltipGroup\r\n                    .attr(\"transform\", \"translate(\" + xScale(getDate(d, data)) + \",\"\r\n                        + (getY(d, data) - legendLineHeight) + \")\")\r\n                    .attr(\"opacity\", 1)\r\n                    .select(\"text\")\r\n                    .selectAll(\"*\")\r\n                    .remove();\r\n                tooltipGroup\r\n                    .select(\"text\")\r\n                    .append(\"tspan\")\r\n                    .text(getRaceName(d.raceId));\r\n                tooltipGroup\r\n                    .select(\"text\")\r\n                    .append(\"tspan\")\r\n                    .attr(\"x\", 5)\r\n                    .attr(\"y\", (legendLineHeight * 2) - 5)\r\n                    .text(\"Place: \" + d.racePlace);\r\n                tooltipGroup\r\n                    .select(\"text\")\r\n                    .append(\"tspan\")\r\n                    .attr(\"x\", 5)\r\n                    .attr(\"y\", (legendLineHeight * 3) - 5)\r\n                    .text(\"Series points: \" + d.seriesPoints);\r\n                onMouseOver(d);\r\n\r\n            }\r\n            function onMouseOut(d) {\r\n                svgElement\r\n                    .selectAll(\"path.compLine\")\r\n                    .attr(\"stroke-width\", 1.5);\r\n                svgElement\r\n                    .selectAll(\"path.compLine\")\r\n                    .attr(\"opacity\", 1);\r\n                svgElement\r\n                    .selectAll(\"g.legendEntry rect\")\r\n                    .attr(\"stroke\", \"none\");\r\n                tooltipGroup\r\n                    .attr(\"opacity\", 0)\r\n                    .attr(\"transform\", \"translate(\" + chartOverallWidth + \",\"\r\n                        + chartOverallHeight + \")\");\r\n\r\n                svgElement\r\n                    .selectAll(\"path.compLine\")\r\n                    .attr(\"opacity\", 1);\r\n                svgElement\r\n                    .selectAll(\"g.legendEntry\")\r\n                    .attr(\"opacity\", 1);\r\n                svgElement.selectAll(\"circle\")\r\n                    .attr(\"opacity\", 1);\r\n            }\r\n\r\n\r\n            var legend = d3.select(elementId)\r\n                .selectAll(\"g.legendEntry\")\r\n                .attr(\"transform\", \"translate(\" + (chartOverallWidth - legendWidth) + \",\" + (margin + legendMargin) + \")\")\r\n                .data(data.competitors)\r\n                .enter()\r\n                .append(\"g\")\r\n                .attr(\"class\", \"legendEntry\")\r\n                .attr(\"data-compId\", d => d.id)\r\n                .attr(\"transform\", function (d, i) {\r\n                    var x = chartOverallWidth - legendWidth;\r\n                    var y = (i * legendLineHeight) + legendMargin + 20;\r\n                    return 'translate(' + x + ',' + y + ')';\r\n                }\r\n                )\r\n                .attr(\"opacity\", 1)\r\n                .on(\"mouseover\", onMouseOver)\r\n                .on(\"mouseout\", onMouseOut);\r\n            legend.append(\"rect\")\r\n                .attr(\"width\", legendWidth - 1)\r\n                .attr(\"height\", legendLineHeight)\r\n                .attr(\"fill\", \"none\")\r\n                .attr(\"stroke-width\", 2);\r\n            legend.append(\"rect\")\r\n                .attr('width', 20 - legendMargin)\r\n                .attr('height', legendLineHeight - 2 * legendMargin)\r\n                .attr(\"x\", legendMargin)\r\n                .attr(\"y\", legendMargin)\r\n                .style('fill', (c) => color(c.id))\r\n                .style('stroke-width', 0);\r\n            legend.append('text')\r\n                .attr('x', 20 + legendMargin)\r\n                .attr(\"y\", legendLineHeight - 4)\r\n                .style(\"font-size\", \"11px\")\r\n                .text(function (d) { return d.name; });\r\n\r\n            var xAxis = d3.axisTop().scale(xScale);\r\n            var language = d3.select(\"html\").attr(\"lang\").substring(0, 2);\r\n            if (((minDate - maxDate) < (10 * 24 * 60 * 60 * 1000)) || language !== \"en\") {\r\n                xAxis = xAxis.tickFormat(\"\");\r\n            }\r\n            svgElement.append(\"g\").attr(\"id\", \"xAxisG\")\r\n                .attr(\"transform\", \"translate(0,20)\").call(xAxis);\r\n\r\n            var lineData = d3.line()\r\n                .x(d => xScale(getDate(d, data)))\r\n                .y(d => getY(d, data));\r\n\r\n            svgElement\r\n                .selectAll(\"path.compLine\")\r\n                .data(data.competitors)\r\n                .enter()\r\n                .append(\"path\")\r\n                .attr(\"class\", \"compLine\")\r\n                .attr(\"d\", d => lineData(data.entries.filter(e => e.competitorId === d.id)))\r\n                .attr(\"fill\", \"none\")\r\n                .attr(\"opacity\", 1)\r\n                .attr(\"stroke\", d => color(d.id))\r\n                .attr(\"stroke-width\", 1)\r\n                .attr(\"stroke-linejoin\", \"round\")\r\n                .attr(\"stroke-linecap\", \"round\")\r\n                .attr(\"data-compId\", d => d.id)\r\n                .on(\"mouseover\", onMouseOver)\r\n                .on(\"mouseout\", onMouseOut);\r\n\r\n            svgElement.selectAll(\"circle\")\r\n                .data(data.entries)\r\n                .enter()\r\n                .append(\"circle\")\r\n                .attr(\"r\", 3)\r\n                .attr(\"cy\", d => getY(d, data))\r\n                .attr(\"cx\", d => xScale(getDate(d, data)))\r\n                .attr(\"data-compId\", d => d.competitorId)\r\n                .attr(\"fill\", d => color(d.competitorId))\r\n                .on(\"mouseover\", onMouseOverRace)\r\n                .on(\"mouseout\", onMouseOut);\r\n\r\n            var tooltipGroup = svgElement\r\n                .append(\"g\")\r\n                .attr(\"opacity\", 0);\r\n            tooltipGroup.append(\"rect\")\r\n                .attr(\"width\", 120)\r\n                .attr(\"height\", legendLineHeight * 3)\r\n                .attr(\"fill\", \"white\")\r\n                .attr(\"fill-opacity\", \".7\");\r\n            tooltipGroup.append(\"text\")\r\n                .attr('x', 5)\r\n                .attr(\"y\", legendLineHeight - 5)\r\n                .style(\"font-size\", \"11px\");\r\n\r\n        }\r\n    }\r\n    return {\r\n        drawChart: drawChart\r\n    };\r\n\r\n})();"],"sourceRoot":""}