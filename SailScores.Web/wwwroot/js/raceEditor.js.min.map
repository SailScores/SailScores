{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"jQuery\"","webpack:///external \"bootstrap\"","webpack:///external \"window[\\\"bootstrap-select\\\"]\"","webpack:///./wwwroot/js/raceEditor.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","jQuery","bootstrap","window","checkEnter","e","ev","event","test","srcElement","tagName","keyCode","which","charCode","initialize","document","querySelector","onkeypress","$","change","loadFleet","val","now","Date","setMinutes","getMinutes","getTimezoneOffset","toISOString","substring","dateChanged","data","raceStateChanged","weatherChanged","on","calculatePlaces","moveUp","moveDown","confirmDelete","addNewCompetitorFromButton","click","deleteResult","hideScoreButtonFooter","submit","compCreateSubmit","form","find","remove","removeScoresFieldsFromForm","resultItems","getElementById","getElementsByTagName","length","listIndex","toString","input","createElement","type","getAttribute","appendChild","shouldCompKeepScore","getCompetitorCode","getCompetitorCodePoints","addScoresFieldsToForm","loadSeriesOptions","prop","RequestAuthorizationToken","clubId","date","getJSON","seriesOptions","seriesSelect","selectedSeriesValues","empty","each","series","append","attr","id","text","selectpicker","setSeries","getSeries","fleetId","sel","boatClassId","options","selectedIndex","getCompetitors","console","log","clearWeatherFields","state","initials","icon","description","windSpeed","windGust","windDirection","temperature","humidity","cloudCoverPercent","preventDefault","show","this","url","ajax","beforeSend","xhr","setRequestHeader","serialize","success","completeCompCreate","error","completeCompCreateFailed","hide","modal","hideAlert","btn","target","resultItem","closest","prev","insertAfter","next","insertBefore","compId","updateButtonFooter","compName","HTMLButtonElement","competitorId","dataset","addNewCompetitor","allCompetitors","competitor","resultDiv","compListItem","cloneNode","setAttribute","span","getElementsByClassName","createTextNode","sailNumber","alternativeSailNumber","style","display","deleteButtons","competitorIsInResults","animate","scrollTop","offset","top","initializeAutoComplete","scoreCount","len","origScore","textContent","removeAttribute","codepointsinput","shouldHaveManualEntry","comp","competitorSuggestions","forEach","initializeButtonFooter","language","region","authorizationToken","timeOfLastToken","timeOfLastRecognized","autoCompleteSetup","push","getSuggestions","autocomplete","dispose","lookup","onSelect","suggestion","autoSelectFirst","triggerSelectOnValidInput","noCache","codeText","codePoints","scoreCodes","filter","formula","continuation","speechInfoUrl","dataType","failureCount","token","userLanguage","textStatus","errorThrown","SpeechSDK","phraseDiv","scenarioStartButton","scenarioStopButton","reco","onRecognized","sender","recognitionEventArgs","result","debug","ResultReason","reason","NoMatch","noMatchDetail","NoMatchDetails","fromResult","NoMatchReason","stopIfTimedOut","Canceled","cancelDetails","CancellationDetails","CancellationReason","Error","errorDetails","RecognizedSpeech","innerHTML","addPotentialMatches","matchString","newResultString","startsWith","normalizeText","substr","trimLeft","scoreCode","sc","last","setLastCompCode","indexOf","onRecognizedResult","fullText","replace","toUpperCase","onSessionStarted","sessionEventArgs","onSessionStopped","onCanceled","cancellationEventArgs","stopContinuousRecognition","doContinuousRecognition","audioConfig","AudioConfig","fromDefaultMicrophoneInput","speechConfig","sdkConfigType","fromAuthorizationToken","setProperty","SpeechServiceConnection_EndSilenceTimeoutMs","speechRecognitionLanguage","getSpeechConfig","SpeechConfig","recognizer","recognized","canceled","sessionStarted","sessionStopped","phraseListGrammar","PhraseListGrammar","fromRecognizer","index","addPhrase","applyCommonConfigurationTo","SpeechRecognizer","startContinuousRecognitionAsync","stopContinuousRecognitionAsync","close","undefined","err","addEventListener","onComplete","speechSdk"],"mappings":"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","file":"raceEditor.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n","module.exports = jQuery;","module.exports = bootstrap;","module.exports = window[\"bootstrap-select\"];","/// <reference path=\"../node_modules/devbridge-autocomplete/typings/jquery-autocomplete/jquery.autocomplete.d.ts\" />\r\n/// <reference types=\"jquery\" />\r\n///\r\nimport \"jquery\";\r\nimport \"bootstrap\";\r\nimport \"bootstrap-select\";\r\nconst noCodeString = \"No Code\";\r\nfunction checkEnter(e) {\r\n    const ev = e || event;\r\n    var txtArea = /textarea/i.test(ev.srcElement.tagName);\r\n    return txtArea || (e.keyCode || e.which || e.charCode || 0) !== 13;\r\n}\r\nexport function initialize() {\r\n    document.querySelector('form').onkeypress = checkEnter;\r\n    $('#fleetId').change(loadFleet);\r\n    if ($('#needsLocalDate').val() === \"True\") {\r\n        var now = new Date();\r\n        now.setMinutes(now.getMinutes() - now.getTimezoneOffset());\r\n        $('#date').val(now.toISOString().substring(0, 10));\r\n        $('#needsLocalDate').val('');\r\n    }\r\n    $('#date').change(dateChanged);\r\n    $('#raceState').data(\"previous\", $('#raceState').val());\r\n    $('#raceState').change(raceStateChanged);\r\n    $('.weather-input').change(weatherChanged);\r\n    $('#results').on('click', '.select-code', calculatePlaces);\r\n    $('#results').on('click', '.move-up', moveUp);\r\n    $('#results').on('click', '.move-down', moveDown);\r\n    $('#results').on('click', '.delete-button', confirmDelete);\r\n    $('#scoreButtonDiv').on('click', '.add-comp-enabled', addNewCompetitorFromButton);\r\n    $('#deleteConfirmed').click(deleteResult);\r\n    $('#closefooter').click(hideScoreButtonFooter);\r\n    $('#compform').submit(compCreateSubmit);\r\n    $(\"#raceform\").submit(function (e) {\r\n        var form = document.getElementById(\"raceform\");\r\n        addScoresFieldsToForm(form);\r\n    });\r\n    loadFleet();\r\n    loadSeriesOptions();\r\n    calculatePlaces();\r\n    $(\"#submitButton\").prop(\"disabled\", false);\r\n    $(\"#submitDisabledMessage\").prop(\"hidden\", true);\r\n    RequestAuthorizationToken(null);\r\n}\r\nexport function loadSeriesOptions() {\r\n    let clubId = $(\"#clubId\").val();\r\n    let dateStr = $(\"#date\").val();\r\n    getSeries(clubId, dateStr);\r\n}\r\nexport function loadFleet() {\r\n    let clubId = $(\"#clubId\").val();\r\n    let fleetId = $(\"#fleetId\").val();\r\n    let sel = document.getElementById('fleetId');\r\n    let option = sel.options[sel.selectedIndex];\r\n    let boatClassId = option.getAttribute('data-boat-class-id');\r\n    if (boatClassId) {\r\n        $(\"#createCompBoatClassSelect\").val(boatClassId);\r\n    }\r\n    if (fleetId.length < 30) {\r\n        $(\"#createCompButton\").prop('disabled', true);\r\n    }\r\n    else {\r\n        $(\"#createCompButton\").prop('disabled', false);\r\n    }\r\n    $(\"#createCompFleetId\").val(fleetId);\r\n    getCompetitors(clubId, fleetId);\r\n}\r\nexport function dateChanged() {\r\n    console.log(\"dateChanged\");\r\n    loadSeriesOptions();\r\n    if ($(\"#defaultWeather\").val() === \"true\") {\r\n        console.log(\"defaultWeather was true\");\r\n        clearWeatherFields();\r\n    }\r\n}\r\nexport function weatherChanged() {\r\n    $(\"#defaultWeather\").val(\"false\");\r\n}\r\nexport function raceStateChanged() {\r\n    let state = $(\"#raceState\").val();\r\n    if (state === \"2\") {\r\n        clearWeatherFields();\r\n    }\r\n    if (state === \"1\" && $(\"#raceState\").data(\"previous\") !== \"4\") {\r\n        populateEmptyWeatherFields();\r\n    }\r\n    $(\"#raceState\").data(\"previous\", state);\r\n}\r\nexport function compCreateSubmit(e) {\r\n    e.preventDefault();\r\n    $(\"#compLoading\").show();\r\n    var form = $(this);\r\n    var url = form.attr(\"data-submit-url\");\r\n    var prep = function (xhr) {\r\n        $('#compLoading').show();\r\n        xhr.setRequestHeader(\"RequestVerificationToken\", $('input:hidden[name=\"__RequestVerificationToken\"]').val());\r\n    };\r\n    $.ajax({\r\n        type: \"POST\",\r\n        url: url,\r\n        beforeSend: prep,\r\n        data: form.serialize(),\r\n        success: completeCompCreate,\r\n        error: completeCompCreateFailed\r\n    });\r\n    $(\"#compLoading\").hide();\r\n    return false;\r\n}\r\nexport function completeCompCreate() {\r\n    let clubId = $(\"#clubId\").val();\r\n    let fleetId = $(\"#fleetId\").val();\r\n    getCompetitors(clubId, fleetId);\r\n    var modal = $(\"#createCompetitor\");\r\n    modal.modal(\"hide\");\r\n}\r\nexport function completeCompCreateFailed() {\r\n    $(\"#compCreateAlert\").show();\r\n}\r\nexport function hideAlert() {\r\n    $(\"#compCreateAlert\").hide();\r\n}\r\nexport function moveUp() {\r\n    var btn = event.target;\r\n    var resultItem = $(btn).closest(\"li\");\r\n    // move up:\r\n    resultItem.prev().insertAfter(resultItem);\r\n    calculatePlaces();\r\n}\r\nexport function moveDown() {\r\n    var btn = event.target;\r\n    var resultItem = $(btn).closest(\"li\");\r\n    resultItem.next().insertBefore(resultItem);\r\n    calculatePlaces();\r\n}\r\nexport function deleteResult() {\r\n    var modal = $(\"#deleteConfirm\");\r\n    var compId = modal.find(\"#compIdToDelete\").val();\r\n    var resultList = $(\"#results\");\r\n    var resultItem = resultList.find(`[data-competitorid='${compId}']`);\r\n    resultItem.remove();\r\n    calculatePlaces();\r\n    updateButtonFooter();\r\n    modal.modal(\"hide\");\r\n}\r\nexport function confirmDelete() {\r\n    var btn = event.target;\r\n    var resultItem = $(btn).closest(\"li\");\r\n    var compId = resultItem.data('competitorid');\r\n    var compName = resultItem.find(\".competitor-name\").text();\r\n    if (!compName) {\r\n        compName = resultItem.find(\".sail-number\").text();\r\n    }\r\n    var modal = $('#deleteConfirm');\r\n    modal.find('#competitorNameToDelete').text(compName);\r\n    modal.find('#compIdToDelete').val(compId);\r\n    modal.show();\r\n}\r\nexport function hideScoreButtonFooter() {\r\n    $('#scoreButtonFooter').hide();\r\n}\r\nexport function addNewCompetitorFromButton() {\r\n    if (!(event.target instanceof HTMLButtonElement)) {\r\n        return;\r\n    }\r\n    var competitorId = event.target.dataset['competitorid'];\r\n    //var competitorId = $(btn).data('id');\r\n    let comp = allCompetitors.find(c => c.id.toString() === competitorId);\r\n    addNewCompetitor(comp);\r\n}\r\nfunction addNewCompetitor(competitor) {\r\n    var c = 0;\r\n    var resultDiv = document.getElementById(\"results\");\r\n    var compTemplate = document.getElementById(\"competitorTemplate\");\r\n    var compListItem = compTemplate.cloneNode(true);\r\n    compListItem.id = competitor.id.toString();\r\n    compListItem.setAttribute(\"data-competitorId\", competitor.id.toString());\r\n    var span = compListItem.getElementsByClassName(\"competitor-name\")[0];\r\n    span.appendChild(document.createTextNode(competitor.name || \"\"));\r\n    span = compListItem.getElementsByClassName(\"sail-number\")[0];\r\n    span.appendChild(document.createTextNode(competitor.sailNumber || \"\"));\r\n    if (competitor.alternativeSailNumber) {\r\n        span = compListItem.getElementsByClassName(\"alt-sail-number\")[0];\r\n        span.appendChild(document.createTextNode(\" (\" + competitor.alternativeSailNumber + \")\"));\r\n        span.style.display = \"\";\r\n    }\r\n    span = compListItem.getElementsByClassName(\"race-place\")[0];\r\n    span.appendChild(document.createTextNode(c.toString()));\r\n    var deleteButtons = compListItem.getElementsByClassName(\"delete-button\");\r\n    for (var i = 0; i < deleteButtons.length; i++) {\r\n        deleteButtons[i].setAttribute(\"data-competitorId\", competitor.id.toString());\r\n    }\r\n    compListItem.style.display = \"\";\r\n    // in testing, due to delay in speech recog, could add competitor\r\n    // twice.Trying to reduce that here.\r\n    if (!competitorIsInResults(competitor)) {\r\n        resultDiv.appendChild(compListItem);\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    calculatePlaces();\r\n    $('html, body').animate({\r\n        scrollTop: $(compListItem).offset().top - 150\r\n    }, 300);\r\n    $('#newCompetitor').val(\"\");\r\n    initializeAutoComplete();\r\n    updateButtonFooter();\r\n}\r\nfunction addScoresFieldsToForm(form) {\r\n    //clear out old fields first:\r\n    removeScoresFieldsFromForm(form);\r\n    var resultList = document.getElementById(\"results\");\r\n    var resultItems = resultList.getElementsByTagName(\"li\");\r\n    for (var i = 1; i < resultItems.length; i++) {\r\n        const listIndex = (i - 1).toString();\r\n        var input = document.createElement(\"input\");\r\n        input.type = \"hidden\";\r\n        input.name = \"Scores\\[\" + listIndex + \"\\].competitorId\";\r\n        input.value = resultItems[i].getAttribute(\"data-competitorId\");\r\n        form.appendChild(input);\r\n        input = document.createElement(\"input\");\r\n        input.type = \"hidden\";\r\n        input.name = \"Scores\\[\" + listIndex + \"\\].place\";\r\n        if (shouldCompKeepScore(resultItems[i])) {\r\n            input.value = resultItems[i].getAttribute(\"data-place\");\r\n        }\r\n        form.appendChild(input);\r\n        input = document.createElement(\"input\");\r\n        input.type = \"hidden\";\r\n        input.name = \"Scores\\[\" + listIndex + \"\\].code\";\r\n        input.value = getCompetitorCode(resultItems[i]);\r\n        form.appendChild(input);\r\n        input = document.createElement(\"input\");\r\n        input.type = \"hidden\";\r\n        input.name = \"Scores\\[\" + listIndex + \"\\].codePointsString\";\r\n        input.value = getCompetitorCodePoints(resultItems[i]);\r\n        form.appendChild(input);\r\n    }\r\n}\r\nfunction removeScoresFieldsFromForm(form) {\r\n    $(form).find(\"[name^=Scores]\").remove();\r\n}\r\nexport function calculatePlaces() {\r\n    var resultList = document.getElementById(\"results\");\r\n    var resultItems = resultList.getElementsByTagName(\"li\");\r\n    var scoreCount = 1;\r\n    for (var i = 1, len = resultItems.length; i < len; i++) {\r\n        var span = resultItems[i].getElementsByClassName(\"race-place\")[0];\r\n        resultItems[i].setAttribute(\"data-place\", i.toString());\r\n        var origScore = resultItems[i].getAttribute(\"data-originalScore\");\r\n        if (span.id !== \"competitorTemplate\") {\r\n            if (shouldCompKeepScore(resultItems[i]) &&\r\n                origScore !== \"0\") {\r\n                span.textContent = (scoreCount).toString();\r\n                resultItems[i].setAttribute(\"data-place\", scoreCount.toString());\r\n                scoreCount++;\r\n            }\r\n            else {\r\n                span.textContent = getCompetitorCode(resultItems[i]);\r\n                resultItems[i].removeAttribute(\"data-place\");\r\n            }\r\n        }\r\n        // show manual entry if needed\r\n        var codepointsinput = resultItems[i].getElementsByClassName(\"code-points\")[0];\r\n        if (shouldHaveManualEntry(resultItems[i])) {\r\n            codepointsinput.style.display = \"\";\r\n        }\r\n        else {\r\n            codepointsinput.style.display = \"none\";\r\n            codepointsinput.value = \"\";\r\n        }\r\n    }\r\n}\r\nfunction competitorIsInResults(comp) {\r\n    var resultList = document.getElementById(\"results\");\r\n    var resultItems = resultList.getElementsByTagName(\"li\");\r\n    for (var i = 0, len = resultItems.length; i < len; i++) {\r\n        if (resultItems[i].getAttribute(\"data-competitorId\")\r\n            === comp.id.toString()) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction getSuggestions() {\r\n    const competitorSuggestions = [];\r\n    allCompetitors.forEach(c => {\r\n        if (!competitorIsInResults(c)) {\r\n            let comp = {\r\n                value: c.name,\r\n                data: c\r\n            };\r\n            if (c.alternativeSailNumber) {\r\n                comp.value = c.sailNumber + \" ( \" +\r\n                    c.alternativeSailNumber + \" ) - \" + c.name;\r\n            }\r\n            else if (c.sailNumber) {\r\n                comp.value = c.sailNumber + ' - ' + c.name;\r\n            }\r\n            competitorSuggestions.push(comp);\r\n        }\r\n    });\r\n    return competitorSuggestions;\r\n}\r\nvar allCompetitors;\r\nvar competitorSuggestions;\r\nfunction getCompetitors(clubId, fleetId) {\r\n    if ($ && clubId && fleetId && fleetId.length > 31) {\r\n        $.getJSON(\"/api/Competitors\", {\r\n            clubId: clubId,\r\n            fleetId: fleetId\r\n        }, function (data) {\r\n            allCompetitors = data;\r\n            initializeAutoComplete();\r\n            initializeButtonFooter();\r\n        });\r\n    }\r\n}\r\nvar seriesOptions;\r\nfunction getSeries(clubId, date) {\r\n    if (clubId && date) {\r\n        $.getJSON(\"/api/Series\", {\r\n            clubId: clubId,\r\n            date: date\r\n        }, function (data) {\r\n            seriesOptions = data;\r\n            setSeries();\r\n        });\r\n    }\r\n}\r\nfunction setSeries() {\r\n    let seriesSelect = $('#seriesIds');\r\n    var selectedSeriesValues = seriesSelect.val();\r\n    seriesSelect.empty();\r\n    $.each(seriesOptions, function (key, value) {\r\n        let series = value;\r\n        seriesSelect.append($(\"<option></option>\")\r\n            .attr(\"value\", series.id.toString()).text(series.name));\r\n    });\r\n    seriesSelect.selectpicker('destroy');\r\n    seriesSelect.selectpicker();\r\n    seriesSelect.val(selectedSeriesValues);\r\n    seriesSelect.selectpicker('refresh');\r\n}\r\nvar autoCompleteSetup = false;\r\nfunction initializeAutoComplete() {\r\n    competitorSuggestions = getSuggestions();\r\n    if (autoCompleteSetup) {\r\n        $('#newCompetitor').autocomplete().dispose();\r\n    }\r\n    $('#newCompetitor').autocomplete({\r\n        lookup: competitorSuggestions,\r\n        onSelect: function (suggestion) {\r\n            addNewCompetitor(suggestion.data);\r\n        },\r\n        autoSelectFirst: true,\r\n        triggerSelectOnValidInput: false,\r\n        noCache: true\r\n    });\r\n    autoCompleteSetup = true;\r\n}\r\nfunction initializeButtonFooter() {\r\n    $('#scoreButtonDiv').empty();\r\n    if (allCompetitors && allCompetitors.length && allCompetitors.length < 21) {\r\n        $('#scoreButtonFooter').show();\r\n    }\r\n    else {\r\n        $('#scoreButtonFooter').hide();\r\n    }\r\n    allCompetitors.forEach(c => {\r\n        let style = 'btn ';\r\n        if (!competitorIsInResults(c)) {\r\n            style += 'btn-outline-primary add-comp-enabled';\r\n        }\r\n        else {\r\n            style += 'btn-primary add-comp-disabled';\r\n        }\r\n        $('#scoreButtonDiv').append('<button class=\"' + style +\r\n            '\" data-competitorid=\"' + c.id + '\" > ' +\r\n            (c.sailNumber || c.alternativeSailNumber || c.name) + ' </button>');\r\n    });\r\n}\r\nfunction updateButtonFooter() {\r\n    $('#scoreButtonDiv').empty();\r\n    allCompetitors.forEach(c => {\r\n        let style = 'btn ';\r\n        if (!competitorIsInResults(c)) {\r\n            style += 'btn-outline-primary add-comp-enabled';\r\n        }\r\n        else {\r\n            style += 'btn-primary add-comp-disabled';\r\n        }\r\n        $('#scoreButtonDiv').append('<button class=\"' + style +\r\n            '\" data-competitorid=\"' + c.id + '\" > ' +\r\n            (c.sailNumber || c.alternativeSailNumber || c.name) + ' </button>');\r\n    });\r\n}\r\nfunction getCompetitorCode(compListItem) {\r\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0].value;\r\n    if (codeText === noCodeString) {\r\n        return null;\r\n    }\r\n    return codeText;\r\n}\r\nfunction getCompetitorCodePoints(compListItem) {\r\n    const codePoints = compListItem.getElementsByClassName(\"code-points\")[0].value;\r\n    if (codePoints === noCodeString) {\r\n        return null;\r\n    }\r\n    return codePoints;\r\n}\r\nfunction shouldCompKeepScore(compListItem) {\r\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0]\r\n        .value;\r\n    if (codeText === noCodeString) {\r\n        return true;\r\n    }\r\n    const fullCodeObj = scoreCodes.filter(s => s.name === codeText);\r\n    return !!(fullCodeObj[0].preserveResult);\r\n}\r\nfunction shouldHaveManualEntry(compListItem) {\r\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0]\r\n        .value;\r\n    if (codeText === noCodeString) {\r\n        return false;\r\n    }\r\n    const fullCodeObj = scoreCodes.filter(s => s.name === codeText);\r\n    return (fullCodeObj[0].formula === \"MAN\");\r\n}\r\nfunction clearWeatherFields() {\r\n    $(\"#weatherIcon\").val(\"Select...\");\r\n    $(\"#weatherIcon\").selectpicker(\"refresh\");\r\n    $(\"#weatherDescription\").val(null);\r\n    $(\"#windSpeed\").val(null);\r\n    $(\"#windGust\").val(null);\r\n    $(\"#windDirection\").val(null);\r\n    $(\"#temperature\").val(null);\r\n    $(\"#humidity\").val(null);\r\n    $(\"#cloudcover\").val(null);\r\n}\r\nfunction populateEmptyWeatherFields() {\r\n    var initials = $(\"#clubInitials\").val();\r\n    $.getJSON(\"/\" + initials + \"/weather/current/\", {}, function (data) {\r\n        if (data.icon && $(\"#weatherIcon\").val(null)) {\r\n            $(\"#weatherIcon\").val(data.icon);\r\n            $(\"#weatherIcon\").selectpicker(\"refresh\");\r\n        }\r\n        if (data.description && $(\"#weatherDescription\").val(null)) {\r\n            $(\"#weatherDescription\").val(data.description);\r\n        }\r\n        if (data.windSpeed && $(\"#windSpeed\").val(null)) {\r\n            $(\"#windSpeed\").val(data.windSpeed);\r\n        }\r\n        if (data.windGust && $(\"#windGust\").val(null)) {\r\n            $(\"#windGust\").val(data.windGust);\r\n        }\r\n        if (data.windDirection && $(\"#windDirection\").val(null)) {\r\n            $(\"#windDirection\").val(data.windDirection);\r\n        }\r\n        if (data.temperature && $(\"#temperature\").val(null)) {\r\n            $(\"#temperature\").val(data.temperature);\r\n        }\r\n        if (data.humidity && $(\"#humidity\").val(null)) {\r\n            $(\"#humidity\").val(data.humidity);\r\n        }\r\n        if (data.cloudCoverPercent && $(\"#cloudCover\").val(null)) {\r\n            $(\"#cloudCover\").val(data.cloudCoverPercent);\r\n        }\r\n    });\r\n}\r\nfunction RequestAuthorizationToken(continuation) {\r\n    var prep = function (xhr) {\r\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\r\n    };\r\n    $.ajax({\r\n        type: \"GET\",\r\n        url: window.speechInfoUrl,\r\n        dataType: \"json\",\r\n        beforeSend: prep,\r\n        success: function (data) {\r\n            failureCount = 0;\r\n            authorizationToken = data.token;\r\n            region = data.region;\r\n            language = data.userLanguage;\r\n            timeOfLastToken = Date.now();\r\n            if (continuation) {\r\n                continuation();\r\n            }\r\n        },\r\n        error: function (xhr, textStatus, errorThrown) {\r\n            failureCount++;\r\n            if (failureCount < 3) {\r\n                $.ajax(this);\r\n                return;\r\n            }\r\n        }\r\n    });\r\n}\r\nfunction InitializeSpeech(onComplete) {\r\n    if (!!window.SpeechSDK) {\r\n        document.getElementById('speechwarning').style.display = 'none';\r\n        onComplete(window.SpeechSDK);\r\n    }\r\n}\r\nvar language;\r\nvar region;\r\nvar authorizationToken;\r\nvar timeOfLastToken;\r\nvar timeOfLastRecognized;\r\nvar failureCount = 0;\r\nvar SpeechSDK;\r\nvar phraseDiv;\r\nvar scenarioStartButton, scenarioStopButton;\r\nvar reco;\r\nfunction resetUiForScenarioStart() {\r\n    phraseDiv.innerHTML = \"\";\r\n}\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n    scenarioStartButton = document.getElementById('scenarioStartButton');\r\n    scenarioStopButton = document.getElementById('scenarioStopButton');\r\n    phraseDiv = document.getElementById(\"phraseDiv\");\r\n    // if the buttons aren't there, don't enable.\r\n    if (!!scenarioStopButton) {\r\n        scenarioStopButton.addEventListener(\"click\", stopContinuousRecognition);\r\n    }\r\n    if (!!scenarioStartButton) {\r\n        scenarioStartButton.addEventListener(\"click\", doContinuousRecognition);\r\n        InitializeSpeech(function (speechSdk) {\r\n            SpeechSDK = speechSdk;\r\n        });\r\n    }\r\n});\r\nfunction getAudioConfig() {\r\n    // Used to have options to choose other microphones.\r\n    return SpeechSDK.AudioConfig.fromDefaultMicrophoneInput();\r\n}\r\nfunction getSpeechConfig(sdkConfigType) {\r\n    var speechConfig;\r\n    if (authorizationToken) {\r\n        speechConfig = sdkConfigType.fromAuthorizationToken(authorizationToken, region);\r\n    }\r\n    // Setting the result output format to Detailed will request that the underlying\r\n    // result JSON include alternates, confidence scores, lexical forms, and other\r\n    // advanced information.\r\n    //speechConfig.outputFormat = SpeechSDK.OutputFormat.Detailed;\r\n    speechConfig.setProperty(SpeechSDK.SpeechServiceConnection_EndSilenceTimeoutMs, 1000);\r\n    speechConfig.speechRecognitionLanguage = language;\r\n    return speechConfig;\r\n}\r\nfunction onRecognized(sender, recognitionEventArgs) {\r\n    onRecognizedResult(recognitionEventArgs.result);\r\n}\r\nfunction onRecognizedResult(result) {\r\n    console.debug(`(recognized)  Reason: ${SpeechSDK.ResultReason[result.reason]}`);\r\n    switch (result.reason) {\r\n        case SpeechSDK.ResultReason.NoMatch:\r\n            var noMatchDetail = SpeechSDK.NoMatchDetails.fromResult(result);\r\n            console.debug(` NoMatchReason: ${SpeechSDK.NoMatchReason[noMatchDetail.reason]}\\r\\n`);\r\n            stopIfTimedOut();\r\n            break;\r\n        case SpeechSDK.ResultReason.Canceled:\r\n            var cancelDetails = SpeechSDK.CancellationDetails.fromResult(result);\r\n            console.debug(` CancellationReason: ${SpeechSDK.CancellationReason[cancelDetails.reason]}`);\r\n            console.debug(cancelDetails.reason === SpeechSDK.CancellationReason.Error\r\n                ? `: ${cancelDetails.errorDetails}` : ``);\r\n            stopIfTimedOut();\r\n            break;\r\n        case SpeechSDK.ResultReason.RecognizedSpeech:\r\n            //var detailedResultJson = JSON.parse(result.json);\r\n            //// Detailed result JSON includes substantial extra information:\r\n            ////  detailedResultJson['NBest'] is an array of recognition alternates\r\n            ////  detailedResultJson['NBest'][0] is the highest-confidence alternate\r\n            ////  ...['Confidence'] is the raw confidence score of an alternate\r\n            ////  ...['Lexical'] and others provide different result forms\r\n            //var displayText = detailedResultJson['DisplayText'];\r\n            //phraseDiv.innerHTML += `Detailed result for \"${displayText}\":\\r\\n`\r\n            //    + `${JSON.stringify(detailedResultJson, null, 2)}\\r\\n`;\r\n            if (result.text) {\r\n                phraseDiv.innerHTML = result.text;\r\n            }\r\n            if (!!result.text) {\r\n                addPotentialMatches(normalizeText(result.text) + \" \");\r\n            }\r\n            break;\r\n    }\r\n}\r\nfunction addPotentialMatches(result) {\r\n    console.debug(result);\r\n    let comp;\r\n    var matchString;\r\n    var newResultString;\r\n    comp =\r\n        allCompetitors.find(c => c.sailNumber && result.startsWith(normalizeText(c.sailNumber) + \" \"));\r\n    if (comp) {\r\n        matchString = normalizeText(comp.sailNumber);\r\n    }\r\n    if (!comp) {\r\n        comp = allCompetitors.find(c => c.alternativeSailNumber && result.startsWith(normalizeText(c.alternativeSailNumber) + \" \"));\r\n        if (comp) {\r\n            matchString = normalizeText(comp.alternativeSailNumber);\r\n        }\r\n    }\r\n    if (!comp) {\r\n        comp =\r\n            allCompetitors.find(c => c.name && result.startsWith(normalizeText(c.name) + \" \"));\r\n        if (comp) {\r\n            matchString = normalizeText(comp.name);\r\n        }\r\n    }\r\n    if (comp) {\r\n        addNewCompetitor(comp);\r\n        timeOfLastRecognized = Date.now();\r\n        newResultString = result.substr(matchString.length).trimLeft();\r\n    }\r\n    else {\r\n        // look for scorecode\r\n        var scoreCode = scoreCodes.find(sc => result.startsWith(normalizeText(sc.name) + \" \"));\r\n        setLastCompCode(scoreCode.name);\r\n        matchString = normalizeText(scoreCode.name);\r\n        newResultString = result.substr(matchString.length).trimLeft();\r\n    }\r\n    if (!comp && !scoreCode) {\r\n        //didn't find anything, trim a word off and try again.\r\n        if (!newResultString && (result.indexOf(\" \") > -1)) {\r\n            newResultString = result.substr(result.indexOf(\" \") + 1).trimLeft();\r\n        }\r\n    }\r\n    if (newResultString.length > 0) {\r\n        addPotentialMatches(newResultString);\r\n    }\r\n    stopIfTimedOut();\r\n}\r\nfunction normalizeText(fullText) {\r\n    if (!!fullText) {\r\n        return fullText.replace(/[.?,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\").toUpperCase();\r\n    }\r\n    return null;\r\n}\r\nfunction onSessionStarted(sender, sessionEventArgs) {\r\n    console.debug(`(sessionStarted)`);\r\n    scenarioStartButton.style.display = \"none\";\r\n    scenarioStopButton.style.display = \"block\";\r\n    phraseDiv.innerHTML = \"Listening\";\r\n}\r\nfunction onSessionStopped(sender, sessionEventArgs) {\r\n    console.debug(`(sessionStopped)`);\r\n    phraseDiv.innerHTML = \"\";\r\n    scenarioStartButton.style.display = \"block\";\r\n    scenarioStopButton.style.display = \"none\";\r\n}\r\nfunction onCanceled(sender, cancellationEventArgs) {\r\n    window.console.log(cancellationEventArgs);\r\n    console.debug(\"(cancel) Reason: \" + SpeechSDK.CancellationReason[cancellationEventArgs.reason]);\r\n    if (cancellationEventArgs.reason === SpeechSDK.CancellationReason.Error) {\r\n        console.debug(\": \" + cancellationEventArgs.errorDetails);\r\n    }\r\n    stopIfTimedOut();\r\n}\r\nfunction applyCommonConfigurationTo(recognizer) {\r\n    recognizer.recognized = onRecognized;\r\n    // The 'canceled' event signals that the service has stopped processing speech.\r\n    // https://docs.microsoft.com/javascript/api/microsoft-cognitiveservices-speech-sdk/speechrecognitioncanceledeventargs?view=azure-node-latest\r\n    // This can happen for two broad classes of reasons:\r\n    // 1. An error was encountered.\r\n    //    In this case, the .errorDetails property will contain a textual representation of the error.\r\n    // 2. No additional audio is available.\r\n    //    This is caused by the input stream being closed or reaching the end of an audio file.\r\n    recognizer.canceled = onCanceled;\r\n    reco.sessionStarted = onSessionStarted;\r\n    reco.sessionStopped = onSessionStopped;\r\n    // PhraseListGrammar allows for the customization of recognizer vocabulary.\r\n    // See https://docs.microsoft.com/azure/cognitive-services/speech-service/get-started-speech-to-text#improve-recognition-accuracy\r\n    if (competitorSuggestions) {\r\n        var phraseListGrammar = SpeechSDK.PhraseListGrammar.fromRecognizer(reco);\r\n        for (var index = 0; index < allCompetitors.length; index++) {\r\n            if (allCompetitors[index].sailNumber) {\r\n                phraseListGrammar.addPhrase(allCompetitors[index].sailNumber);\r\n            }\r\n            if (allCompetitors[index].alternativeSailNumber) {\r\n                phraseListGrammar.addPhrase(allCompetitors[index].alternativeSailNumber);\r\n            }\r\n            if (allCompetitors[index].name) {\r\n                phraseListGrammar.addPhrase(allCompetitors[index].name);\r\n            }\r\n        }\r\n        for (var index = 0; index < scoreCodes.length; index++) {\r\n            phraseListGrammar.addPhrase(scoreCodes[index].name);\r\n        }\r\n    }\r\n}\r\nfunction stopIfTimedOut() {\r\n    if (timeOfLastRecognized < Date.now() - (30000)) {\r\n        stopContinuousRecognition();\r\n    }\r\n}\r\nfunction doContinuousRecognition() {\r\n    resetUiForScenarioStart();\r\n    timeOfLastRecognized = Date.now();\r\n    if (timeOfLastToken < Date.now() - (5 * 60000)) {\r\n        RequestAuthorizationToken(doContinuousRecognition);\r\n        return;\r\n    }\r\n    var audioConfig = getAudioConfig();\r\n    var speechConfig = getSpeechConfig(SpeechSDK.SpeechConfig);\r\n    if (!speechConfig)\r\n        return;\r\n    // Create the SpeechRecognizer and set up common event handlers and PhraseList data\r\n    reco = new SpeechSDK.SpeechRecognizer(speechConfig, audioConfig);\r\n    applyCommonConfigurationTo(reco);\r\n    reco.startContinuousRecognitionAsync();\r\n}\r\nfunction stopContinuousRecognition() {\r\n    reco.stopContinuousRecognitionAsync(function () {\r\n        reco.close();\r\n        reco = undefined;\r\n    }, function (err) {\r\n        reco.close();\r\n        reco = undefined;\r\n    });\r\n}\r\nfunction setLastCompCode(scoreCode) {\r\n    $(\".select-code\").last().val(scoreCode);\r\n}\r\ninitialize();\r\n//# sourceMappingURL=raceEditor.js.map"],"sourceRoot":""}