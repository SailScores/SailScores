{"version":3,"file":"raceEditor.js","mappings":"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","sources":["webpack://asp.net/webpack/bootstrap","webpack://asp.net/webpack/runtime/compat get default export","webpack://asp.net/webpack/runtime/define property getters","webpack://asp.net/webpack/runtime/hasOwnProperty shorthand","webpack://asp.net/external var \"jQuery\"","webpack://asp.net/external var \"bootstrap\"","webpack://asp.net/external var \"window[\\\"bootstrap-select\\\"]\"","webpack://asp.net/./wwwroot/js/raceEditor.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = jQuery;","const __WEBPACK_NAMESPACE_OBJECT__ = bootstrap;","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"bootstrap-select\"];","/// <reference path=\"../node_modules/devbridge-autocomplete/typings/jquery-autocomplete/jquery.autocomplete.d.ts\" />\n/// <reference types=\"jquery\" />\n///\nimport $ from \"jquery\";\nimport \"bootstrap\";\nimport \"bootstrap-select\";\nconst noCodeString = \"No Code\";\nfunction checkEnter(e) {\n    const ev = e || event;\n    var txtArea = /textarea/i.test(ev.srcElement.tagName);\n    return txtArea || (e.keyCode || e.which || e.charCode || 0) !== 13;\n}\nexport function initialize() {\n    document.querySelector('form').onkeypress = checkEnter;\n    $('#fleetId').change(loadFleet);\n    if ($('#needsLocalDate').val() === \"True\") {\n        var now = new Date();\n        now.setMinutes(now.getMinutes() - now.getTimezoneOffset());\n        $('#date').val(now.toISOString().substring(0, 10));\n        $('#needsLocalDate').val('');\n    }\n    $('#date').change(dateChanged);\n    $('#raceState').data(\"previous\", $('#raceState').val());\n    $('#raceState').change(raceStateChanged);\n    $('.weather-input').change(weatherChanged);\n    $('#results').on('click', '.select-code', calculatePlaces);\n    $('#results').on('click', '.move-up', moveUp);\n    $('#results').on('click', '.move-down', moveDown);\n    $('#results').on('click', '.delete-button', confirmDelete);\n    $('#scoreButtonDiv').on('click', '.add-comp-enabled', addNewCompetitorFromButton);\n    $('#deleteConfirmed').click(deleteResult);\n    $('#closefooter').click(hideScoreButtonFooter);\n    $('#compform').submit(compCreateSubmit);\n    $(\"#raceform\").submit(function (e) {\n        var waiting = $('#ssWaitingModal');\n        if (!!waiting) {\n            waiting.show();\n        }\n        $('#submitButton').attr('value', 'Please wait...');\n        var form = document.getElementById(\"raceform\");\n        $('#submitButton').attr('disabled', 'disabled');\n        addScoresFieldsToForm(form);\n    });\n    loadFleet();\n    loadSeriesOptions();\n    calculatePlaces();\n    $(\"#submitButton\").prop(\"disabled\", false);\n    $(\"#submitDisabledMessage\").prop(\"hidden\", true);\n    RequestAuthorizationToken(null);\n}\nexport function loadSeriesOptions() {\n    let clubId = $(\"#clubId\").val();\n    let dateStr = $(\"#date\").val();\n    getSeries(clubId, dateStr);\n}\nexport function loadFleet() {\n    let clubId = $(\"#clubId\").val();\n    let fleetId = $(\"#fleetId\").val();\n    let sel = document.getElementById('fleetId');\n    let option = sel.options[sel.selectedIndex];\n    let boatClassId = option.getAttribute('data-boat-class-id');\n    if (boatClassId) {\n        $(\"#createCompBoatClassSelect\").val(boatClassId);\n    }\n    if (fleetId.length < 30) {\n        $(\"#createCompButton\").prop('disabled', true);\n    }\n    else {\n        $(\"#createCompButton\").prop('disabled', false);\n    }\n    $(\"#createCompFleetId\").val(fleetId);\n    getCompetitors(clubId, fleetId);\n}\nexport function dateChanged() {\n    console.log(\"dateChanged\");\n    loadSeriesOptions();\n    if ($(\"#defaultWeather\").val() === \"true\") {\n        console.log(\"defaultWeather was true\");\n        clearWeatherFields();\n    }\n}\nexport function weatherChanged() {\n    $(\"#defaultWeather\").val(\"false\");\n}\nexport function raceStateChanged() {\n    let state = $(\"#raceState\").val();\n    if (state === \"2\") {\n        clearWeatherFields();\n    }\n    if (state === \"1\" && $(\"#raceState\").data(\"previous\") !== \"4\") {\n        populateEmptyWeatherFields();\n    }\n    $(\"#raceState\").data(\"previous\", state);\n}\nexport function compCreateSubmit(e) {\n    e.preventDefault();\n    $(\"#compLoading\").show();\n    var form = $(this);\n    var url = form.attr(\"data-submit-url\");\n    var prep = function (xhr) {\n        $('#compLoading').show();\n        xhr.setRequestHeader(\"RequestVerificationToken\", $('input:hidden[name=\"__RequestVerificationToken\"]').val());\n    };\n    $.ajax({\n        type: \"POST\",\n        url: url,\n        beforeSend: prep,\n        data: form.serialize(), // serializes the form's elements.\n        success: completeCompCreate,\n        error: completeCompCreateFailed\n    });\n    $(\"#compLoading\").hide();\n    return false;\n}\nexport function completeCompCreate() {\n    let clubId = $(\"#clubId\").val();\n    let fleetId = $(\"#fleetId\").val();\n    getCompetitors(clubId, fleetId);\n    var modal = $(\"#createCompetitor\");\n    modal.modal(\"hide\");\n}\nexport function completeCompCreateFailed() {\n    $(\"#compCreateAlert\").show();\n}\nexport function hideAlert() {\n    $(\"#compCreateAlert\").hide();\n}\nexport function moveUp() {\n    var btn = event.target;\n    var resultItem = $(btn).closest(\"li\");\n    // move up:\n    resultItem.prev().insertAfter(resultItem);\n    calculatePlaces();\n}\nexport function moveDown() {\n    var btn = event.target;\n    var resultItem = $(btn).closest(\"li\");\n    resultItem.next().insertBefore(resultItem);\n    calculatePlaces();\n}\nexport function deleteResult() {\n    // fix aria incompatibility.\n    const buttonElement = document.activeElement;\n    buttonElement.blur();\n    var modal = $(\"#deleteConfirm\");\n    var compId = modal.find(\"#compIdToDelete\").val();\n    var resultList = $(\"#results\");\n    var resultItem = resultList.find(`[data-competitorid='${compId}']`);\n    resultItem.remove();\n    calculatePlaces();\n    initializeAutoComplete();\n    updateButtonFooter();\n    modal.modal(\"hide\");\n}\nexport function confirmDelete() {\n    var btn = event.target;\n    var resultItem = $(btn).closest(\"li\");\n    var compId = resultItem.data('competitorid');\n    var compName = resultItem.find(\".competitor-name\").text();\n    if (!compName) {\n        compName = resultItem.find(\".sail-number\").text();\n    }\n    var modal = $('#deleteConfirm');\n    modal.find('#competitorNameToDelete').text(compName);\n    modal.find('#compIdToDelete').val(compId);\n    modal.show();\n}\nexport function hideScoreButtonFooter() {\n    $('#scoreButtonFooter').hide();\n}\nexport function addNewCompetitorFromButton() {\n    if (!(event.target instanceof HTMLButtonElement)) {\n        return;\n    }\n    var competitorId = event.target.dataset['competitorid'];\n    //var competitorId = $(btn).data('id');\n    let comp = allCompetitors.find(c => c.id.toString() === competitorId);\n    addNewCompetitor(comp);\n}\nfunction addNewCompetitor(competitor) {\n    var c = 0;\n    var resultDiv = document.getElementById(\"results\");\n    var compTemplate = document.getElementById(\"competitorTemplate\");\n    var compListItem = compTemplate.cloneNode(true);\n    compListItem.id = competitor.id.toString();\n    compListItem.setAttribute(\"data-competitorId\", competitor.id.toString());\n    var span = compListItem.getElementsByClassName(\"competitor-name\")[0];\n    span.appendChild(document.createTextNode(competitor.name || \"\"));\n    span = compListItem.getElementsByClassName(\"sail-number\")[0];\n    span.appendChild(document.createTextNode(competitor.sailNumber || \"\"));\n    if (competitor.alternativeSailNumber) {\n        span = compListItem.getElementsByClassName(\"alt-sail-number\")[0];\n        span.appendChild(document.createTextNode(\" (\" + competitor.alternativeSailNumber + \")\"));\n        span.style.display = \"\";\n    }\n    span = compListItem.getElementsByClassName(\"race-place\")[0];\n    span.appendChild(document.createTextNode(c.toString()));\n    var deleteButtons = compListItem.getElementsByClassName(\"delete-button\");\n    for (var i = 0; i < deleteButtons.length; i++) {\n        deleteButtons[i].setAttribute(\"data-competitorId\", competitor.id.toString());\n    }\n    compListItem.style.display = \"\";\n    // in testing, due to delay in speech recog, could add competitor\n    // twice.Trying to reduce that here.\n    if (!competitorIsInResults(competitor)) {\n        resultDiv.appendChild(compListItem);\n    }\n    else {\n        return;\n    }\n    calculatePlaces();\n    $('html, body').animate({\n        scrollTop: $(compListItem).offset().top - 150\n    }, 300);\n    $('#newCompetitor').val(\"\");\n    initializeAutoComplete();\n    updateButtonFooter();\n}\nfunction addScoresFieldsToForm(form) {\n    //clear out old fields first:\n    removeScoresFieldsFromForm(form);\n    var resultList = document.getElementById(\"results\");\n    var resultItems = resultList.getElementsByTagName(\"li\");\n    for (var i = 1; i < resultItems.length; i++) {\n        const listIndex = (i - 1).toString();\n        var input = document.createElement(\"input\");\n        input.type = \"hidden\";\n        input.name = \"Scores\\[\" + listIndex + \"\\].competitorId\";\n        input.value = resultItems[i].getAttribute(\"data-competitorId\");\n        form.appendChild(input);\n        input = document.createElement(\"input\");\n        input.type = \"hidden\";\n        input.name = \"Scores\\[\" + listIndex + \"\\].place\";\n        if (shouldCompKeepScore(resultItems[i])) {\n            input.value = resultItems[i].getAttribute(\"data-place\");\n        }\n        form.appendChild(input);\n        input = document.createElement(\"input\");\n        input.type = \"hidden\";\n        input.name = \"Scores\\[\" + listIndex + \"\\].code\";\n        input.value = getCompetitorCode(resultItems[i]);\n        form.appendChild(input);\n        input = document.createElement(\"input\");\n        input.type = \"hidden\";\n        input.name = \"Scores\\[\" + listIndex + \"\\].codePointsString\";\n        input.value = getCompetitorCodePoints(resultItems[i]);\n        form.appendChild(input);\n    }\n}\nfunction removeScoresFieldsFromForm(form) {\n    $(form).find(\"[name^=Scores]\").remove();\n}\nexport function calculatePlaces() {\n    var resultList = document.getElementById(\"results\");\n    var resultItems = resultList.getElementsByTagName(\"li\");\n    var scoreCount = 1;\n    for (var i = 1, len = resultItems.length; i < len; i++) {\n        var span = resultItems[i].getElementsByClassName(\"race-place\")[0];\n        resultItems[i].setAttribute(\"data-place\", i.toString());\n        var origScore = resultItems[i].getAttribute(\"data-originalScore\");\n        if (span.id !== \"competitorTemplate\") {\n            if (shouldCompKeepScore(resultItems[i]) &&\n                origScore !== \"0\") {\n                span.textContent = (scoreCount).toString();\n                resultItems[i].setAttribute(\"data-place\", scoreCount.toString());\n                scoreCount++;\n            }\n            else {\n                span.textContent = getCompetitorCode(resultItems[i]);\n                resultItems[i].removeAttribute(\"data-place\");\n            }\n        }\n        // show manual entry if needed\n        var codepointsinput = resultItems[i].getElementsByClassName(\"code-points\")[0];\n        if (shouldHaveManualEntry(resultItems[i])) {\n            codepointsinput.style.display = \"\";\n        }\n        else {\n            codepointsinput.style.display = \"none\";\n            codepointsinput.value = \"\";\n        }\n    }\n}\nfunction competitorIsInResults(comp) {\n    var resultList = document.getElementById(\"results\");\n    var resultItems = resultList.getElementsByTagName(\"li\");\n    for (var i = 0, len = resultItems.length; i < len; i++) {\n        if (resultItems[i].getAttribute(\"data-competitorId\")\n            === comp.id.toString()) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction getSuggestions() {\n    const competitorSuggestions = [];\n    allCompetitors.forEach(c => {\n        if (!competitorIsInResults(c)) {\n            let comp = {\n                value: c.name,\n                data: c\n            };\n            if (c.alternativeSailNumber) {\n                comp.value = c.sailNumber + \" ( \" +\n                    c.alternativeSailNumber + \" ) - \" + c.name;\n            }\n            else if (c.sailNumber) {\n                comp.value = c.sailNumber + ' - ' + c.name;\n            }\n            competitorSuggestions.push(comp);\n        }\n    });\n    return competitorSuggestions;\n}\nvar allCompetitors;\nvar competitorSuggestions;\nfunction getCompetitors(clubId, fleetId) {\n    if ($ && clubId && fleetId && fleetId.length > 31) {\n        $.getJSON(\"/api/Competitors\", {\n            clubId: clubId,\n            fleetId: fleetId\n        }, function (data) {\n            allCompetitors = data;\n            initializeAutoComplete();\n            initializeButtonFooter();\n        });\n    }\n}\nvar seriesOptions;\nfunction getSeries(clubId, date) {\n    if (clubId && date) {\n        $.getJSON(\"/api/Series\", {\n            clubId: clubId,\n            date: date\n        }, function (data) {\n            seriesOptions = data;\n            setSeries();\n        });\n    }\n}\nfunction setSeries() {\n    let seriesSelect = $('#seriesIds');\n    var selectedSeriesValues = seriesSelect.val();\n    seriesSelect.empty();\n    $.each(seriesOptions, function (key, value) {\n        let series = value;\n        seriesSelect.append($(\"<option></option>\")\n            .attr(\"value\", series.id.toString()).text(series.name));\n    });\n    seriesSelect.selectpicker('destroy');\n    seriesSelect.selectpicker();\n    seriesSelect.val(selectedSeriesValues);\n    seriesSelect.selectpicker('refresh');\n}\nvar autoCompleteSetup = false;\nfunction initializeAutoComplete() {\n    competitorSuggestions = getSuggestions();\n    if (autoCompleteSetup) {\n        $('#newCompetitor').autocomplete().dispose();\n    }\n    $('#newCompetitor').autocomplete({\n        lookup: competitorSuggestions,\n        onSelect: function (suggestion) {\n            addNewCompetitor(suggestion.data);\n        },\n        autoSelectFirst: true,\n        triggerSelectOnValidInput: false,\n        noCache: true\n    });\n    autoCompleteSetup = true;\n}\nfunction initializeButtonFooter() {\n    $('#scoreButtonDiv').empty();\n    if (allCompetitors && allCompetitors.length && allCompetitors.length < 21) {\n        $('#scoreButtonFooter').show();\n    }\n    else {\n        $('#scoreButtonFooter').hide();\n    }\n    allCompetitors.forEach(c => {\n        let style = 'btn ';\n        if (!competitorIsInResults(c)) {\n            style += 'btn-outline-primary add-comp-enabled';\n        }\n        else {\n            style += 'btn-primary add-comp-disabled';\n        }\n        $('#scoreButtonDiv').append('<button class=\"' + style +\n            '\" data-competitorid=\"' + c.id + '\" > ' +\n            (c.sailNumber || c.alternativeSailNumber || c.name) + ' </button>');\n    });\n}\nfunction updateButtonFooter() {\n    $('#scoreButtonDiv').empty();\n    allCompetitors.forEach(c => {\n        let style = 'btn ';\n        if (!competitorIsInResults(c)) {\n            style += 'btn-outline-primary add-comp-enabled';\n        }\n        else {\n            style += 'btn-primary add-comp-disabled';\n        }\n        $('#scoreButtonDiv').append('<button class=\"' + style +\n            '\" data-competitorid=\"' + c.id + '\" > ' +\n            (c.sailNumber || c.alternativeSailNumber || c.name) + ' </button>');\n    });\n}\nfunction getCompetitorCode(compListItem) {\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0].value;\n    if (codeText === noCodeString) {\n        return null;\n    }\n    return codeText;\n}\nfunction getCompetitorCodePoints(compListItem) {\n    const codePoints = compListItem.getElementsByClassName(\"code-points\")[0].value;\n    if (codePoints === noCodeString) {\n        return null;\n    }\n    return codePoints;\n}\nfunction shouldCompKeepScore(compListItem) {\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0]\n        .value;\n    if (codeText === noCodeString) {\n        return true;\n    }\n    const fullCodeObj = scoreCodes.filter(s => s.name === codeText);\n    return !!(fullCodeObj[0].preserveResult);\n}\nfunction shouldHaveManualEntry(compListItem) {\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0]\n        .value;\n    if (codeText === noCodeString) {\n        return false;\n    }\n    const fullCodeObj = scoreCodes.filter(s => s.name === codeText);\n    return (fullCodeObj[0].formula === \"MAN\");\n}\nfunction clearWeatherFields() {\n    $(\"#weatherIcon\").val(\"Select...\");\n    $(\"#weatherIcon\").selectpicker(\"refresh\");\n    $(\"#weatherDescription\").val(null);\n    $(\"#windSpeed\").val(null);\n    $(\"#windGust\").val(null);\n    $(\"#windDirection\").val(null);\n    $(\"#temperature\").val(null);\n    $(\"#humidity\").val(null);\n    $(\"#cloudcover\").val(null);\n}\nfunction populateEmptyWeatherFields() {\n    var initials = $(\"#clubInitials\").val();\n    $.getJSON(\"/\" + initials + \"/weather/current/\", {}, function (data) {\n        if (data.icon && $(\"#weatherIcon\").val(null)) {\n            $(\"#weatherIcon\").val(data.icon);\n            $(\"#weatherIcon\").selectpicker(\"refresh\");\n        }\n        if (data.description && $(\"#weatherDescription\").val(null)) {\n            $(\"#weatherDescription\").val(data.description);\n        }\n        if (data.windSpeed && $(\"#windSpeed\").val(null)) {\n            $(\"#windSpeed\").val(data.windSpeed);\n        }\n        if (data.windGust && $(\"#windGust\").val(null)) {\n            $(\"#windGust\").val(data.windGust);\n        }\n        if (data.windDirection && $(\"#windDirection\").val(null)) {\n            $(\"#windDirection\").val(data.windDirection);\n        }\n        if (data.temperature && $(\"#temperature\").val(null)) {\n            $(\"#temperature\").val(data.temperature);\n        }\n        if (data.humidity && $(\"#humidity\").val(null)) {\n            $(\"#humidity\").val(data.humidity);\n        }\n        if (data.cloudCoverPercent && $(\"#cloudCover\").val(null)) {\n            $(\"#cloudCover\").val(data.cloudCoverPercent);\n        }\n    });\n}\nfunction RequestAuthorizationToken(continuation) {\n    var prep = function (xhr) {\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\n    };\n    $.ajax({\n        type: \"GET\",\n        url: window.speechInfoUrl,\n        dataType: \"json\",\n        beforeSend: prep,\n        success: function (data) {\n            failureCount = 0;\n            authorizationToken = data.token;\n            region = data.region;\n            language = data.userLanguage;\n            timeOfLastToken = Date.now();\n            if (continuation) {\n                continuation();\n            }\n        },\n        error: function (xhr, textStatus, errorThrown) {\n            failureCount++;\n            if (failureCount < 3) {\n                $.ajax(this);\n                return;\n            }\n        }\n    });\n}\nfunction InitializeSpeech(onComplete) {\n    if (!!window.SpeechSDK) {\n        document.getElementById('speechwarning').style.display = 'none';\n        onComplete(window.SpeechSDK);\n    }\n}\nvar language;\nvar region;\nvar authorizationToken;\nvar timeOfLastToken;\nvar timeOfLastRecognized;\nvar failureCount = 0;\nvar SpeechSDK;\nvar phraseDiv;\nvar scenarioStartButton, scenarioStopButton;\nvar reco;\nfunction resetUiForScenarioStart() {\n    phraseDiv.innerHTML = \"\";\n}\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n    scenarioStartButton = document.getElementById('scenarioStartButton');\n    scenarioStopButton = document.getElementById('scenarioStopButton');\n    phraseDiv = document.getElementById(\"phraseDiv\");\n    // if the buttons aren't there, don't enable.\n    if (!!scenarioStopButton) {\n        scenarioStopButton.addEventListener(\"click\", stopContinuousRecognition);\n    }\n    if (!!scenarioStartButton) {\n        scenarioStartButton.addEventListener(\"click\", doContinuousRecognition);\n        InitializeSpeech(function (speechSdk) {\n            SpeechSDK = speechSdk;\n        });\n    }\n});\nfunction getAudioConfig() {\n    // Used to have options to choose other microphones.\n    return SpeechSDK.AudioConfig.fromDefaultMicrophoneInput();\n}\nfunction getSpeechConfig(sdkConfigType) {\n    var speechConfig;\n    if (authorizationToken) {\n        speechConfig = sdkConfigType.fromAuthorizationToken(authorizationToken, region);\n    }\n    // Setting the result output format to Detailed will request that the underlying\n    // result JSON include alternates, confidence scores, lexical forms, and other\n    // advanced information.\n    //speechConfig.outputFormat = SpeechSDK.OutputFormat.Detailed;\n    speechConfig.setProperty(SpeechSDK.SpeechServiceConnection_EndSilenceTimeoutMs, 1000);\n    speechConfig.speechRecognitionLanguage = language;\n    return speechConfig;\n}\nfunction onRecognized(sender, recognitionEventArgs) {\n    onRecognizedResult(recognitionEventArgs.result);\n}\nfunction onRecognizedResult(result) {\n    console.debug(`(recognized)  Reason: ${SpeechSDK.ResultReason[result.reason]}`);\n    switch (result.reason) {\n        case SpeechSDK.ResultReason.NoMatch:\n            var noMatchDetail = SpeechSDK.NoMatchDetails.fromResult(result);\n            console.debug(` NoMatchReason: ${SpeechSDK.NoMatchReason[noMatchDetail.reason]}\\r\\n`);\n            stopIfTimedOut();\n            break;\n        case SpeechSDK.ResultReason.Canceled:\n            var cancelDetails = SpeechSDK.CancellationDetails.fromResult(result);\n            console.debug(` CancellationReason: ${SpeechSDK.CancellationReason[cancelDetails.reason]}`);\n            console.debug(cancelDetails.reason === SpeechSDK.CancellationReason.Error\n                ? `: ${cancelDetails.errorDetails}` : ``);\n            stopIfTimedOut();\n            break;\n        case SpeechSDK.ResultReason.RecognizedSpeech:\n            //var detailedResultJson = JSON.parse(result.json);\n            //// Detailed result JSON includes substantial extra information:\n            ////  detailedResultJson['NBest'] is an array of recognition alternates\n            ////  detailedResultJson['NBest'][0] is the highest-confidence alternate\n            ////  ...['Confidence'] is the raw confidence score of an alternate\n            ////  ...['Lexical'] and others provide different result forms\n            //var displayText = detailedResultJson['DisplayText'];\n            //phraseDiv.innerHTML += `Detailed result for \"${displayText}\":\\r\\n`\n            //    + `${JSON.stringify(detailedResultJson, null, 2)}\\r\\n`;\n            if (result.text) {\n                phraseDiv.innerHTML = result.text;\n            }\n            if (!!result.text) {\n                addPotentialMatches(normalizeText(result.text) + \" \");\n            }\n            break;\n    }\n}\nfunction addPotentialMatches(result) {\n    console.debug(result);\n    let comp;\n    var matchString;\n    var newResultString;\n    comp =\n        allCompetitors.find(c => c.sailNumber && result.startsWith(normalizeText(c.sailNumber) + \" \"));\n    if (comp) {\n        matchString = normalizeText(comp.sailNumber);\n    }\n    if (!comp) {\n        comp = allCompetitors.find(c => c.alternativeSailNumber && result.startsWith(normalizeText(c.alternativeSailNumber) + \" \"));\n        if (comp) {\n            matchString = normalizeText(comp.alternativeSailNumber);\n        }\n    }\n    if (!comp) {\n        comp =\n            allCompetitors.find(c => c.name && result.startsWith(normalizeText(c.name) + \" \"));\n        if (comp) {\n            matchString = normalizeText(comp.name);\n        }\n    }\n    if (comp) {\n        addNewCompetitor(comp);\n        timeOfLastRecognized = Date.now();\n        newResultString = result.substr(matchString.length).trimLeft();\n    }\n    else {\n        // look for scorecode\n        var scoreCode = scoreCodes.find(sc => result.startsWith(normalizeText(sc.name) + \" \"));\n        setLastCompCode(scoreCode.name);\n        matchString = normalizeText(scoreCode.name);\n        newResultString = result.substr(matchString.length).trimLeft();\n    }\n    if (!comp && !scoreCode) {\n        //didn't find anything, trim a word off and try again.\n        if (!newResultString && (result.indexOf(\" \") > -1)) {\n            newResultString = result.substr(result.indexOf(\" \") + 1).trimLeft();\n        }\n    }\n    if (newResultString.length > 0) {\n        addPotentialMatches(newResultString);\n    }\n    stopIfTimedOut();\n}\nfunction normalizeText(fullText) {\n    if (!!fullText) {\n        return fullText.replace(/[.?,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\").toUpperCase();\n    }\n    return null;\n}\nfunction onSessionStarted(sender, sessionEventArgs) {\n    console.debug(`(sessionStarted)`);\n    scenarioStartButton.style.display = \"none\";\n    scenarioStopButton.style.display = \"block\";\n    phraseDiv.innerHTML = \"Listening\";\n}\nfunction onSessionStopped(sender, sessionEventArgs) {\n    console.debug(`(sessionStopped)`);\n    phraseDiv.innerHTML = \"\";\n    scenarioStartButton.style.display = \"block\";\n    scenarioStopButton.style.display = \"none\";\n}\nfunction onCanceled(sender, cancellationEventArgs) {\n    window.console.log(cancellationEventArgs);\n    console.debug(\"(cancel) Reason: \" + SpeechSDK.CancellationReason[cancellationEventArgs.reason]);\n    if (cancellationEventArgs.reason === SpeechSDK.CancellationReason.Error) {\n        console.debug(\": \" + cancellationEventArgs.errorDetails);\n    }\n    stopIfTimedOut();\n}\nfunction applyCommonConfigurationTo(recognizer) {\n    recognizer.recognized = onRecognized;\n    // The 'canceled' event signals that the service has stopped processing speech.\n    // https://docs.microsoft.com/javascript/api/microsoft-cognitiveservices-speech-sdk/speechrecognitioncanceledeventargs?view=azure-node-latest\n    // This can happen for two broad classes of reasons:\n    // 1. An error was encountered.\n    //    In this case, the .errorDetails property will contain a textual representation of the error.\n    // 2. No additional audio is available.\n    //    This is caused by the input stream being closed or reaching the end of an audio file.\n    recognizer.canceled = onCanceled;\n    reco.sessionStarted = onSessionStarted;\n    reco.sessionStopped = onSessionStopped;\n    // PhraseListGrammar allows for the customization of recognizer vocabulary.\n    // See https://docs.microsoft.com/azure/cognitive-services/speech-service/get-started-speech-to-text#improve-recognition-accuracy\n    if (competitorSuggestions) {\n        var phraseListGrammar = SpeechSDK.PhraseListGrammar.fromRecognizer(reco);\n        for (var index = 0; index < allCompetitors.length; index++) {\n            if (allCompetitors[index].sailNumber) {\n                phraseListGrammar.addPhrase(allCompetitors[index].sailNumber);\n            }\n            if (allCompetitors[index].alternativeSailNumber) {\n                phraseListGrammar.addPhrase(allCompetitors[index].alternativeSailNumber);\n            }\n            if (allCompetitors[index].name) {\n                phraseListGrammar.addPhrase(allCompetitors[index].name);\n            }\n        }\n        for (var index = 0; index < scoreCodes.length; index++) {\n            phraseListGrammar.addPhrase(scoreCodes[index].name);\n        }\n    }\n}\nfunction stopIfTimedOut() {\n    if (timeOfLastRecognized < Date.now() - (30000)) {\n        stopContinuousRecognition();\n    }\n}\nfunction doContinuousRecognition() {\n    resetUiForScenarioStart();\n    timeOfLastRecognized = Date.now();\n    if (timeOfLastToken < Date.now() - (5 * 60000)) {\n        RequestAuthorizationToken(doContinuousRecognition);\n        return;\n    }\n    var audioConfig = getAudioConfig();\n    var speechConfig = getSpeechConfig(SpeechSDK.SpeechConfig);\n    if (!speechConfig)\n        return;\n    // Create the SpeechRecognizer and set up common event handlers and PhraseList data\n    reco = new SpeechSDK.SpeechRecognizer(speechConfig, audioConfig);\n    applyCommonConfigurationTo(reco);\n    reco.startContinuousRecognitionAsync();\n}\nfunction stopContinuousRecognition() {\n    reco.stopContinuousRecognitionAsync(function () {\n        reco.close();\n        reco = undefined;\n    }, function (err) {\n        reco.close();\n        reco = undefined;\n    });\n}\nfunction setLastCompCode(scoreCode) {\n    $(\".select-code\").last().val(scoreCode);\n}\ninitialize();\n//# sourceMappingURL=raceEditor.js.map"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","jQuery","bootstrap","window","noCodeString","checkEnter","e","ev","event","test","srcElement","tagName","keyCode","which","charCode","loadSeriesOptions","clubId","date","val","data","seriesOptions","seriesSelect","selectedSeriesValues","empty","value","series","append","attr","id","toString","text","name","selectpicker","setSeries","loadFleet","fleetId","sel","document","getElementById","boatClassId","options","selectedIndex","getAttribute","length","getCompetitors","dateChanged","console","log","clearWeatherFields","weatherChanged","raceStateChanged","state","initials","icon","description","windSpeed","windGust","windDirection","temperature","humidity","cloudCoverPercent","compCreateSubmit","preventDefault","show","form","this","url","type","beforeSend","xhr","setRequestHeader","serialize","success","completeCompCreate","error","completeCompCreateFailed","hide","modal","moveUp","btn","target","resultItem","closest","prev","insertAfter","calculatePlaces","moveDown","next","insertBefore","deleteResult","activeElement","blur","compId","find","remove","initializeAutoComplete","updateButtonFooter","confirmDelete","compName","hideScoreButtonFooter","addNewCompetitorFromButton","HTMLButtonElement","competitorId","dataset","addNewCompetitor","allCompetitors","c","competitor","resultDiv","compListItem","cloneNode","setAttribute","span","getElementsByClassName","appendChild","createTextNode","sailNumber","alternativeSailNumber","style","display","deleteButtons","i","competitorIsInResults","animate","scrollTop","offset","top","resultItems","getElementsByTagName","scoreCount","len","origScore","shouldCompKeepScore","textContent","getCompetitorCode","removeAttribute","codepointsinput","shouldHaveManualEntry","comp","competitorSuggestions","forEach","language","region","authorizationToken","timeOfLastToken","timeOfLastRecognized","autoCompleteSetup","push","getSuggestions","autocomplete","dispose","lookup","onSelect","suggestion","autoSelectFirst","triggerSelectOnValidInput","noCache","codeText","getCompetitorCodePoints","codePoints","scoreCodes","filter","s","formula","RequestAuthorizationToken","continuation","speechInfoUrl","dataType","failureCount","token","userLanguage","Date","now","textStatus","errorThrown","SpeechSDK","phraseDiv","scenarioStartButton","scenarioStopButton","reco","onRecognized","sender","recognitionEventArgs","result","debug","ResultReason","reason","NoMatch","noMatchDetail","NoMatchDetails","fromResult","NoMatchReason","stopIfTimedOut","Canceled","cancelDetails","CancellationDetails","CancellationReason","Error","errorDetails","RecognizedSpeech","innerHTML","addPotentialMatches","normalizeText","onRecognizedResult","matchString","newResultString","startsWith","substr","trimLeft","scoreCode","sc","last","setLastCompCode","indexOf","fullText","replace","toUpperCase","onSessionStarted","sessionEventArgs","onSessionStopped","onCanceled","cancellationEventArgs","stopContinuousRecognition","doContinuousRecognition","audioConfig","AudioConfig","fromDefaultMicrophoneInput","speechConfig","sdkConfigType","fromAuthorizationToken","setProperty","SpeechServiceConnection_EndSilenceTimeoutMs","speechRecognitionLanguage","getSpeechConfig","SpeechConfig","recognizer","recognized","canceled","sessionStarted","sessionStopped","phraseListGrammar","PhraseListGrammar","fromRecognizer","index","addPhrase","applyCommonConfigurationTo","SpeechRecognizer","startContinuousRecognitionAsync","stopContinuousRecognitionAsync","close","undefined","err","addEventListener","onComplete","speechSdk","querySelector","onkeypress","change","setMinutes","getMinutes","getTimezoneOffset","toISOString","substring","on","click","submit","waiting","removeScoresFieldsFromForm","listIndex","input","createElement","addScoresFieldsToForm","initialize"],"sourceRoot":""}