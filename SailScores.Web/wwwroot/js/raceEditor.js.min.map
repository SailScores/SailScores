{"version":3,"file":"raceEditor.js","mappings":"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","sources":["webpack://asp.net/webpack/bootstrap","webpack://asp.net/webpack/runtime/compat get default export","webpack://asp.net/webpack/runtime/define property getters","webpack://asp.net/webpack/runtime/hasOwnProperty shorthand","webpack://asp.net/external var \"jQuery\"","webpack://asp.net/external var \"bootstrap\"","webpack://asp.net/external var \"window[\\\"bootstrap-select\\\"]\"","webpack://asp.net/./wwwroot/js/raceEditor.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = jQuery;","const __WEBPACK_NAMESPACE_OBJECT__ = bootstrap;","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"bootstrap-select\"];","/// <reference path=\"../node_modules/devbridge-autocomplete/typings/jquery-autocomplete/jquery.autocomplete.d.ts\" />\r\n/// <reference types=\"jquery\" />\r\n///\r\nimport $ from \"jquery\";\r\nimport \"bootstrap\";\r\nimport \"bootstrap-select\";\r\nconst noCodeString = \"No Code\";\r\nfunction checkEnter(e) {\r\n    const ev = e || event;\r\n    var txtArea = /textarea/i.test(ev.srcElement.tagName);\r\n    return txtArea || (e.keyCode || e.which || e.charCode || 0) !== 13;\r\n}\r\nexport function initialize() {\r\n    document.querySelector('form').onkeypress = checkEnter;\r\n    $('#fleetId').change(loadFleet);\r\n    if ($('#needsLocalDate').val() === \"True\") {\r\n        var now = new Date();\r\n        now.setMinutes(now.getMinutes() - now.getTimezoneOffset());\r\n        $('#date').val(now.toISOString().substring(0, 10));\r\n        $('#needsLocalDate').val('');\r\n    }\r\n    $('#date').change(dateChanged);\r\n    $('#raceState').data(\"previous\", $('#raceState').val());\r\n    $('#raceState').change(raceStateChanged);\r\n    $('.weather-input').change(weatherChanged);\r\n    $('#results').on('click', '.select-code', calculatePlaces);\r\n    $('#results').on('click', '.move-up', moveUp);\r\n    $('#results').on('click', '.move-down', moveDown);\r\n    $('#results').on('click', '.delete-button', confirmDelete);\r\n    $('#scoreButtonDiv').on('click', '.add-comp-enabled', addNewCompetitorFromButton);\r\n    $('#deleteConfirmed').click(deleteResult);\r\n    $('#closefooter').click(hideScoreButtonFooter);\r\n    $('#compform').submit(compCreateSubmit);\r\n    $(\"#raceform\").submit(function (e) {\r\n        var form = document.getElementById(\"raceform\");\r\n        addScoresFieldsToForm(form);\r\n        $('#submitButton').attr('disabled', 'disabled');\r\n    });\r\n    loadFleet();\r\n    loadSeriesOptions();\r\n    calculatePlaces();\r\n    $(\"#submitButton\").prop(\"disabled\", false);\r\n    $(\"#submitDisabledMessage\").prop(\"hidden\", true);\r\n    RequestAuthorizationToken(null);\r\n}\r\nexport function loadSeriesOptions() {\r\n    let clubId = $(\"#clubId\").val();\r\n    let dateStr = $(\"#date\").val();\r\n    getSeries(clubId, dateStr);\r\n}\r\nexport function loadFleet() {\r\n    let clubId = $(\"#clubId\").val();\r\n    let fleetId = $(\"#fleetId\").val();\r\n    let sel = document.getElementById('fleetId');\r\n    let option = sel.options[sel.selectedIndex];\r\n    let boatClassId = option.getAttribute('data-boat-class-id');\r\n    if (boatClassId) {\r\n        $(\"#createCompBoatClassSelect\").val(boatClassId);\r\n    }\r\n    if (fleetId.length < 30) {\r\n        $(\"#createCompButton\").prop('disabled', true);\r\n    }\r\n    else {\r\n        $(\"#createCompButton\").prop('disabled', false);\r\n    }\r\n    $(\"#createCompFleetId\").val(fleetId);\r\n    getCompetitors(clubId, fleetId);\r\n}\r\nexport function dateChanged() {\r\n    console.log(\"dateChanged\");\r\n    loadSeriesOptions();\r\n    if ($(\"#defaultWeather\").val() === \"true\") {\r\n        console.log(\"defaultWeather was true\");\r\n        clearWeatherFields();\r\n    }\r\n}\r\nexport function weatherChanged() {\r\n    $(\"#defaultWeather\").val(\"false\");\r\n}\r\nexport function raceStateChanged() {\r\n    let state = $(\"#raceState\").val();\r\n    if (state === \"2\") {\r\n        clearWeatherFields();\r\n    }\r\n    if (state === \"1\" && $(\"#raceState\").data(\"previous\") !== \"4\") {\r\n        populateEmptyWeatherFields();\r\n    }\r\n    $(\"#raceState\").data(\"previous\", state);\r\n}\r\nexport function compCreateSubmit(e) {\r\n    e.preventDefault();\r\n    $(\"#compLoading\").show();\r\n    var form = $(this);\r\n    var url = form.attr(\"data-submit-url\");\r\n    var prep = function (xhr) {\r\n        $('#compLoading').show();\r\n        xhr.setRequestHeader(\"RequestVerificationToken\", $('input:hidden[name=\"__RequestVerificationToken\"]').val());\r\n    };\r\n    $.ajax({\r\n        type: \"POST\",\r\n        url: url,\r\n        beforeSend: prep,\r\n        data: form.serialize(),\r\n        success: completeCompCreate,\r\n        error: completeCompCreateFailed\r\n    });\r\n    $(\"#compLoading\").hide();\r\n    return false;\r\n}\r\nexport function completeCompCreate() {\r\n    let clubId = $(\"#clubId\").val();\r\n    let fleetId = $(\"#fleetId\").val();\r\n    getCompetitors(clubId, fleetId);\r\n    var modal = $(\"#createCompetitor\");\r\n    modal.modal(\"hide\");\r\n}\r\nexport function completeCompCreateFailed() {\r\n    $(\"#compCreateAlert\").show();\r\n}\r\nexport function hideAlert() {\r\n    $(\"#compCreateAlert\").hide();\r\n}\r\nexport function moveUp() {\r\n    var btn = event.target;\r\n    var resultItem = $(btn).closest(\"li\");\r\n    // move up:\r\n    resultItem.prev().insertAfter(resultItem);\r\n    calculatePlaces();\r\n}\r\nexport function moveDown() {\r\n    var btn = event.target;\r\n    var resultItem = $(btn).closest(\"li\");\r\n    resultItem.next().insertBefore(resultItem);\r\n    calculatePlaces();\r\n}\r\nexport function deleteResult() {\r\n    var modal = $(\"#deleteConfirm\");\r\n    var compId = modal.find(\"#compIdToDelete\").val();\r\n    var resultList = $(\"#results\");\r\n    var resultItem = resultList.find(`[data-competitorid='${compId}']`);\r\n    resultItem.remove();\r\n    calculatePlaces();\r\n    updateButtonFooter();\r\n    modal.modal(\"hide\");\r\n}\r\nexport function confirmDelete() {\r\n    var btn = event.target;\r\n    var resultItem = $(btn).closest(\"li\");\r\n    var compId = resultItem.data('competitorid');\r\n    var compName = resultItem.find(\".competitor-name\").text();\r\n    if (!compName) {\r\n        compName = resultItem.find(\".sail-number\").text();\r\n    }\r\n    var modal = $('#deleteConfirm');\r\n    modal.find('#competitorNameToDelete').text(compName);\r\n    modal.find('#compIdToDelete').val(compId);\r\n    modal.show();\r\n}\r\nexport function hideScoreButtonFooter() {\r\n    $('#scoreButtonFooter').hide();\r\n}\r\nexport function addNewCompetitorFromButton() {\r\n    if (!(event.target instanceof HTMLButtonElement)) {\r\n        return;\r\n    }\r\n    var competitorId = event.target.dataset['competitorid'];\r\n    //var competitorId = $(btn).data('id');\r\n    let comp = allCompetitors.find(c => c.id.toString() === competitorId);\r\n    addNewCompetitor(comp);\r\n}\r\nfunction addNewCompetitor(competitor) {\r\n    var c = 0;\r\n    var resultDiv = document.getElementById(\"results\");\r\n    var compTemplate = document.getElementById(\"competitorTemplate\");\r\n    var compListItem = compTemplate.cloneNode(true);\r\n    compListItem.id = competitor.id.toString();\r\n    compListItem.setAttribute(\"data-competitorId\", competitor.id.toString());\r\n    var span = compListItem.getElementsByClassName(\"competitor-name\")[0];\r\n    span.appendChild(document.createTextNode(competitor.name || \"\"));\r\n    span = compListItem.getElementsByClassName(\"sail-number\")[0];\r\n    span.appendChild(document.createTextNode(competitor.sailNumber || \"\"));\r\n    if (competitor.alternativeSailNumber) {\r\n        span = compListItem.getElementsByClassName(\"alt-sail-number\")[0];\r\n        span.appendChild(document.createTextNode(\" (\" + competitor.alternativeSailNumber + \")\"));\r\n        span.style.display = \"\";\r\n    }\r\n    span = compListItem.getElementsByClassName(\"race-place\")[0];\r\n    span.appendChild(document.createTextNode(c.toString()));\r\n    var deleteButtons = compListItem.getElementsByClassName(\"delete-button\");\r\n    for (var i = 0; i < deleteButtons.length; i++) {\r\n        deleteButtons[i].setAttribute(\"data-competitorId\", competitor.id.toString());\r\n    }\r\n    compListItem.style.display = \"\";\r\n    // in testing, due to delay in speech recog, could add competitor\r\n    // twice.Trying to reduce that here.\r\n    if (!competitorIsInResults(competitor)) {\r\n        resultDiv.appendChild(compListItem);\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    calculatePlaces();\r\n    $('html, body').animate({\r\n        scrollTop: $(compListItem).offset().top - 150\r\n    }, 300);\r\n    $('#newCompetitor').val(\"\");\r\n    initializeAutoComplete();\r\n    updateButtonFooter();\r\n}\r\nfunction addScoresFieldsToForm(form) {\r\n    //clear out old fields first:\r\n    removeScoresFieldsFromForm(form);\r\n    var resultList = document.getElementById(\"results\");\r\n    var resultItems = resultList.getElementsByTagName(\"li\");\r\n    for (var i = 1; i < resultItems.length; i++) {\r\n        const listIndex = (i - 1).toString();\r\n        var input = document.createElement(\"input\");\r\n        input.type = \"hidden\";\r\n        input.name = \"Scores\\[\" + listIndex + \"\\].competitorId\";\r\n        input.value = resultItems[i].getAttribute(\"data-competitorId\");\r\n        form.appendChild(input);\r\n        input = document.createElement(\"input\");\r\n        input.type = \"hidden\";\r\n        input.name = \"Scores\\[\" + listIndex + \"\\].place\";\r\n        if (shouldCompKeepScore(resultItems[i])) {\r\n            input.value = resultItems[i].getAttribute(\"data-place\");\r\n        }\r\n        form.appendChild(input);\r\n        input = document.createElement(\"input\");\r\n        input.type = \"hidden\";\r\n        input.name = \"Scores\\[\" + listIndex + \"\\].code\";\r\n        input.value = getCompetitorCode(resultItems[i]);\r\n        form.appendChild(input);\r\n        input = document.createElement(\"input\");\r\n        input.type = \"hidden\";\r\n        input.name = \"Scores\\[\" + listIndex + \"\\].codePointsString\";\r\n        input.value = getCompetitorCodePoints(resultItems[i]);\r\n        form.appendChild(input);\r\n    }\r\n}\r\nfunction removeScoresFieldsFromForm(form) {\r\n    $(form).find(\"[name^=Scores]\").remove();\r\n}\r\nexport function calculatePlaces() {\r\n    var resultList = document.getElementById(\"results\");\r\n    var resultItems = resultList.getElementsByTagName(\"li\");\r\n    var scoreCount = 1;\r\n    for (var i = 1, len = resultItems.length; i < len; i++) {\r\n        var span = resultItems[i].getElementsByClassName(\"race-place\")[0];\r\n        resultItems[i].setAttribute(\"data-place\", i.toString());\r\n        var origScore = resultItems[i].getAttribute(\"data-originalScore\");\r\n        if (span.id !== \"competitorTemplate\") {\r\n            if (shouldCompKeepScore(resultItems[i]) &&\r\n                origScore !== \"0\") {\r\n                span.textContent = (scoreCount).toString();\r\n                resultItems[i].setAttribute(\"data-place\", scoreCount.toString());\r\n                scoreCount++;\r\n            }\r\n            else {\r\n                span.textContent = getCompetitorCode(resultItems[i]);\r\n                resultItems[i].removeAttribute(\"data-place\");\r\n            }\r\n        }\r\n        // show manual entry if needed\r\n        var codepointsinput = resultItems[i].getElementsByClassName(\"code-points\")[0];\r\n        if (shouldHaveManualEntry(resultItems[i])) {\r\n            codepointsinput.style.display = \"\";\r\n        }\r\n        else {\r\n            codepointsinput.style.display = \"none\";\r\n            codepointsinput.value = \"\";\r\n        }\r\n    }\r\n}\r\nfunction competitorIsInResults(comp) {\r\n    var resultList = document.getElementById(\"results\");\r\n    var resultItems = resultList.getElementsByTagName(\"li\");\r\n    for (var i = 0, len = resultItems.length; i < len; i++) {\r\n        if (resultItems[i].getAttribute(\"data-competitorId\")\r\n            === comp.id.toString()) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction getSuggestions() {\r\n    const competitorSuggestions = [];\r\n    allCompetitors.forEach(c => {\r\n        if (!competitorIsInResults(c)) {\r\n            let comp = {\r\n                value: c.name,\r\n                data: c\r\n            };\r\n            if (c.alternativeSailNumber) {\r\n                comp.value = c.sailNumber + \" ( \" +\r\n                    c.alternativeSailNumber + \" ) - \" + c.name;\r\n            }\r\n            else if (c.sailNumber) {\r\n                comp.value = c.sailNumber + ' - ' + c.name;\r\n            }\r\n            competitorSuggestions.push(comp);\r\n        }\r\n    });\r\n    return competitorSuggestions;\r\n}\r\nvar allCompetitors;\r\nvar competitorSuggestions;\r\nfunction getCompetitors(clubId, fleetId) {\r\n    if ($ && clubId && fleetId && fleetId.length > 31) {\r\n        $.getJSON(\"/api/Competitors\", {\r\n            clubId: clubId,\r\n            fleetId: fleetId\r\n        }, function (data) {\r\n            allCompetitors = data;\r\n            initializeAutoComplete();\r\n            initializeButtonFooter();\r\n        });\r\n    }\r\n}\r\nvar seriesOptions;\r\nfunction getSeries(clubId, date) {\r\n    if (clubId && date) {\r\n        $.getJSON(\"/api/Series\", {\r\n            clubId: clubId,\r\n            date: date\r\n        }, function (data) {\r\n            seriesOptions = data;\r\n            setSeries();\r\n        });\r\n    }\r\n}\r\nfunction setSeries() {\r\n    let seriesSelect = $('#seriesIds');\r\n    var selectedSeriesValues = seriesSelect.val();\r\n    seriesSelect.empty();\r\n    $.each(seriesOptions, function (key, value) {\r\n        let series = value;\r\n        seriesSelect.append($(\"<option></option>\")\r\n            .attr(\"value\", series.id.toString()).text(series.name));\r\n    });\r\n    seriesSelect.selectpicker('destroy');\r\n    seriesSelect.selectpicker();\r\n    seriesSelect.val(selectedSeriesValues);\r\n    seriesSelect.selectpicker('refresh');\r\n}\r\nvar autoCompleteSetup = false;\r\nfunction initializeAutoComplete() {\r\n    competitorSuggestions = getSuggestions();\r\n    if (autoCompleteSetup) {\r\n        $('#newCompetitor').autocomplete().dispose();\r\n    }\r\n    $('#newCompetitor').autocomplete({\r\n        lookup: competitorSuggestions,\r\n        onSelect: function (suggestion) {\r\n            addNewCompetitor(suggestion.data);\r\n        },\r\n        autoSelectFirst: true,\r\n        triggerSelectOnValidInput: false,\r\n        noCache: true\r\n    });\r\n    autoCompleteSetup = true;\r\n}\r\nfunction initializeButtonFooter() {\r\n    $('#scoreButtonDiv').empty();\r\n    if (allCompetitors && allCompetitors.length && allCompetitors.length < 21) {\r\n        $('#scoreButtonFooter').show();\r\n    }\r\n    else {\r\n        $('#scoreButtonFooter').hide();\r\n    }\r\n    allCompetitors.forEach(c => {\r\n        let style = 'btn ';\r\n        if (!competitorIsInResults(c)) {\r\n            style += 'btn-outline-primary add-comp-enabled';\r\n        }\r\n        else {\r\n            style += 'btn-primary add-comp-disabled';\r\n        }\r\n        $('#scoreButtonDiv').append('<button class=\"' + style +\r\n            '\" data-competitorid=\"' + c.id + '\" > ' +\r\n            (c.sailNumber || c.alternativeSailNumber || c.name) + ' </button>');\r\n    });\r\n}\r\nfunction updateButtonFooter() {\r\n    $('#scoreButtonDiv').empty();\r\n    allCompetitors.forEach(c => {\r\n        let style = 'btn ';\r\n        if (!competitorIsInResults(c)) {\r\n            style += 'btn-outline-primary add-comp-enabled';\r\n        }\r\n        else {\r\n            style += 'btn-primary add-comp-disabled';\r\n        }\r\n        $('#scoreButtonDiv').append('<button class=\"' + style +\r\n            '\" data-competitorid=\"' + c.id + '\" > ' +\r\n            (c.sailNumber || c.alternativeSailNumber || c.name) + ' </button>');\r\n    });\r\n}\r\nfunction getCompetitorCode(compListItem) {\r\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0].value;\r\n    if (codeText === noCodeString) {\r\n        return null;\r\n    }\r\n    return codeText;\r\n}\r\nfunction getCompetitorCodePoints(compListItem) {\r\n    const codePoints = compListItem.getElementsByClassName(\"code-points\")[0].value;\r\n    if (codePoints === noCodeString) {\r\n        return null;\r\n    }\r\n    return codePoints;\r\n}\r\nfunction shouldCompKeepScore(compListItem) {\r\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0]\r\n        .value;\r\n    if (codeText === noCodeString) {\r\n        return true;\r\n    }\r\n    const fullCodeObj = scoreCodes.filter(s => s.name === codeText);\r\n    return !!(fullCodeObj[0].preserveResult);\r\n}\r\nfunction shouldHaveManualEntry(compListItem) {\r\n    const codeText = compListItem.getElementsByClassName(\"select-code\")[0]\r\n        .value;\r\n    if (codeText === noCodeString) {\r\n        return false;\r\n    }\r\n    const fullCodeObj = scoreCodes.filter(s => s.name === codeText);\r\n    return (fullCodeObj[0].formula === \"MAN\");\r\n}\r\nfunction clearWeatherFields() {\r\n    $(\"#weatherIcon\").val(\"Select...\");\r\n    $(\"#weatherIcon\").selectpicker(\"refresh\");\r\n    $(\"#weatherDescription\").val(null);\r\n    $(\"#windSpeed\").val(null);\r\n    $(\"#windGust\").val(null);\r\n    $(\"#windDirection\").val(null);\r\n    $(\"#temperature\").val(null);\r\n    $(\"#humidity\").val(null);\r\n    $(\"#cloudcover\").val(null);\r\n}\r\nfunction populateEmptyWeatherFields() {\r\n    var initials = $(\"#clubInitials\").val();\r\n    $.getJSON(\"/\" + initials + \"/weather/current/\", {}, function (data) {\r\n        if (data.icon && $(\"#weatherIcon\").val(null)) {\r\n            $(\"#weatherIcon\").val(data.icon);\r\n            $(\"#weatherIcon\").selectpicker(\"refresh\");\r\n        }\r\n        if (data.description && $(\"#weatherDescription\").val(null)) {\r\n            $(\"#weatherDescription\").val(data.description);\r\n        }\r\n        if (data.windSpeed && $(\"#windSpeed\").val(null)) {\r\n            $(\"#windSpeed\").val(data.windSpeed);\r\n        }\r\n        if (data.windGust && $(\"#windGust\").val(null)) {\r\n            $(\"#windGust\").val(data.windGust);\r\n        }\r\n        if (data.windDirection && $(\"#windDirection\").val(null)) {\r\n            $(\"#windDirection\").val(data.windDirection);\r\n        }\r\n        if (data.temperature && $(\"#temperature\").val(null)) {\r\n            $(\"#temperature\").val(data.temperature);\r\n        }\r\n        if (data.humidity && $(\"#humidity\").val(null)) {\r\n            $(\"#humidity\").val(data.humidity);\r\n        }\r\n        if (data.cloudCoverPercent && $(\"#cloudCover\").val(null)) {\r\n            $(\"#cloudCover\").val(data.cloudCoverPercent);\r\n        }\r\n    });\r\n}\r\nfunction RequestAuthorizationToken(continuation) {\r\n    var prep = function (xhr) {\r\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\r\n    };\r\n    $.ajax({\r\n        type: \"GET\",\r\n        url: window.speechInfoUrl,\r\n        dataType: \"json\",\r\n        beforeSend: prep,\r\n        success: function (data) {\r\n            failureCount = 0;\r\n            authorizationToken = data.token;\r\n            region = data.region;\r\n            language = data.userLanguage;\r\n            timeOfLastToken = Date.now();\r\n            if (continuation) {\r\n                continuation();\r\n            }\r\n        },\r\n        error: function (xhr, textStatus, errorThrown) {\r\n            failureCount++;\r\n            if (failureCount < 3) {\r\n                $.ajax(this);\r\n                return;\r\n            }\r\n        }\r\n    });\r\n}\r\nfunction InitializeSpeech(onComplete) {\r\n    if (!!window.SpeechSDK) {\r\n        document.getElementById('speechwarning').style.display = 'none';\r\n        onComplete(window.SpeechSDK);\r\n    }\r\n}\r\nvar language;\r\nvar region;\r\nvar authorizationToken;\r\nvar timeOfLastToken;\r\nvar timeOfLastRecognized;\r\nvar failureCount = 0;\r\nvar SpeechSDK;\r\nvar phraseDiv;\r\nvar scenarioStartButton, scenarioStopButton;\r\nvar reco;\r\nfunction resetUiForScenarioStart() {\r\n    phraseDiv.innerHTML = \"\";\r\n}\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n    scenarioStartButton = document.getElementById('scenarioStartButton');\r\n    scenarioStopButton = document.getElementById('scenarioStopButton');\r\n    phraseDiv = document.getElementById(\"phraseDiv\");\r\n    // if the buttons aren't there, don't enable.\r\n    if (!!scenarioStopButton) {\r\n        scenarioStopButton.addEventListener(\"click\", stopContinuousRecognition);\r\n    }\r\n    if (!!scenarioStartButton) {\r\n        scenarioStartButton.addEventListener(\"click\", doContinuousRecognition);\r\n        InitializeSpeech(function (speechSdk) {\r\n            SpeechSDK = speechSdk;\r\n        });\r\n    }\r\n});\r\nfunction getAudioConfig() {\r\n    // Used to have options to choose other microphones.\r\n    return SpeechSDK.AudioConfig.fromDefaultMicrophoneInput();\r\n}\r\nfunction getSpeechConfig(sdkConfigType) {\r\n    var speechConfig;\r\n    if (authorizationToken) {\r\n        speechConfig = sdkConfigType.fromAuthorizationToken(authorizationToken, region);\r\n    }\r\n    // Setting the result output format to Detailed will request that the underlying\r\n    // result JSON include alternates, confidence scores, lexical forms, and other\r\n    // advanced information.\r\n    //speechConfig.outputFormat = SpeechSDK.OutputFormat.Detailed;\r\n    speechConfig.setProperty(SpeechSDK.SpeechServiceConnection_EndSilenceTimeoutMs, 1000);\r\n    speechConfig.speechRecognitionLanguage = language;\r\n    return speechConfig;\r\n}\r\nfunction onRecognized(sender, recognitionEventArgs) {\r\n    onRecognizedResult(recognitionEventArgs.result);\r\n}\r\nfunction onRecognizedResult(result) {\r\n    console.debug(`(recognized)  Reason: ${SpeechSDK.ResultReason[result.reason]}`);\r\n    switch (result.reason) {\r\n        case SpeechSDK.ResultReason.NoMatch:\r\n            var noMatchDetail = SpeechSDK.NoMatchDetails.fromResult(result);\r\n            console.debug(` NoMatchReason: ${SpeechSDK.NoMatchReason[noMatchDetail.reason]}\\r\\n`);\r\n            stopIfTimedOut();\r\n            break;\r\n        case SpeechSDK.ResultReason.Canceled:\r\n            var cancelDetails = SpeechSDK.CancellationDetails.fromResult(result);\r\n            console.debug(` CancellationReason: ${SpeechSDK.CancellationReason[cancelDetails.reason]}`);\r\n            console.debug(cancelDetails.reason === SpeechSDK.CancellationReason.Error\r\n                ? `: ${cancelDetails.errorDetails}` : ``);\r\n            stopIfTimedOut();\r\n            break;\r\n        case SpeechSDK.ResultReason.RecognizedSpeech:\r\n            //var detailedResultJson = JSON.parse(result.json);\r\n            //// Detailed result JSON includes substantial extra information:\r\n            ////  detailedResultJson['NBest'] is an array of recognition alternates\r\n            ////  detailedResultJson['NBest'][0] is the highest-confidence alternate\r\n            ////  ...['Confidence'] is the raw confidence score of an alternate\r\n            ////  ...['Lexical'] and others provide different result forms\r\n            //var displayText = detailedResultJson['DisplayText'];\r\n            //phraseDiv.innerHTML += `Detailed result for \"${displayText}\":\\r\\n`\r\n            //    + `${JSON.stringify(detailedResultJson, null, 2)}\\r\\n`;\r\n            if (result.text) {\r\n                phraseDiv.innerHTML = result.text;\r\n            }\r\n            if (!!result.text) {\r\n                addPotentialMatches(normalizeText(result.text) + \" \");\r\n            }\r\n            break;\r\n    }\r\n}\r\nfunction addPotentialMatches(result) {\r\n    console.debug(result);\r\n    let comp;\r\n    var matchString;\r\n    var newResultString;\r\n    comp =\r\n        allCompetitors.find(c => c.sailNumber && result.startsWith(normalizeText(c.sailNumber) + \" \"));\r\n    if (comp) {\r\n        matchString = normalizeText(comp.sailNumber);\r\n    }\r\n    if (!comp) {\r\n        comp = allCompetitors.find(c => c.alternativeSailNumber && result.startsWith(normalizeText(c.alternativeSailNumber) + \" \"));\r\n        if (comp) {\r\n            matchString = normalizeText(comp.alternativeSailNumber);\r\n        }\r\n    }\r\n    if (!comp) {\r\n        comp =\r\n            allCompetitors.find(c => c.name && result.startsWith(normalizeText(c.name) + \" \"));\r\n        if (comp) {\r\n            matchString = normalizeText(comp.name);\r\n        }\r\n    }\r\n    if (comp) {\r\n        addNewCompetitor(comp);\r\n        timeOfLastRecognized = Date.now();\r\n        newResultString = result.substr(matchString.length).trimLeft();\r\n    }\r\n    else {\r\n        // look for scorecode\r\n        var scoreCode = scoreCodes.find(sc => result.startsWith(normalizeText(sc.name) + \" \"));\r\n        setLastCompCode(scoreCode.name);\r\n        matchString = normalizeText(scoreCode.name);\r\n        newResultString = result.substr(matchString.length).trimLeft();\r\n    }\r\n    if (!comp && !scoreCode) {\r\n        //didn't find anything, trim a word off and try again.\r\n        if (!newResultString && (result.indexOf(\" \") > -1)) {\r\n            newResultString = result.substr(result.indexOf(\" \") + 1).trimLeft();\r\n        }\r\n    }\r\n    if (newResultString.length > 0) {\r\n        addPotentialMatches(newResultString);\r\n    }\r\n    stopIfTimedOut();\r\n}\r\nfunction normalizeText(fullText) {\r\n    if (!!fullText) {\r\n        return fullText.replace(/[.?,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\").toUpperCase();\r\n    }\r\n    return null;\r\n}\r\nfunction onSessionStarted(sender, sessionEventArgs) {\r\n    console.debug(`(sessionStarted)`);\r\n    scenarioStartButton.style.display = \"none\";\r\n    scenarioStopButton.style.display = \"block\";\r\n    phraseDiv.innerHTML = \"Listening\";\r\n}\r\nfunction onSessionStopped(sender, sessionEventArgs) {\r\n    console.debug(`(sessionStopped)`);\r\n    phraseDiv.innerHTML = \"\";\r\n    scenarioStartButton.style.display = \"block\";\r\n    scenarioStopButton.style.display = \"none\";\r\n}\r\nfunction onCanceled(sender, cancellationEventArgs) {\r\n    window.console.log(cancellationEventArgs);\r\n    console.debug(\"(cancel) Reason: \" + SpeechSDK.CancellationReason[cancellationEventArgs.reason]);\r\n    if (cancellationEventArgs.reason === SpeechSDK.CancellationReason.Error) {\r\n        console.debug(\": \" + cancellationEventArgs.errorDetails);\r\n    }\r\n    stopIfTimedOut();\r\n}\r\nfunction applyCommonConfigurationTo(recognizer) {\r\n    recognizer.recognized = onRecognized;\r\n    // The 'canceled' event signals that the service has stopped processing speech.\r\n    // https://docs.microsoft.com/javascript/api/microsoft-cognitiveservices-speech-sdk/speechrecognitioncanceledeventargs?view=azure-node-latest\r\n    // This can happen for two broad classes of reasons:\r\n    // 1. An error was encountered.\r\n    //    In this case, the .errorDetails property will contain a textual representation of the error.\r\n    // 2. No additional audio is available.\r\n    //    This is caused by the input stream being closed or reaching the end of an audio file.\r\n    recognizer.canceled = onCanceled;\r\n    reco.sessionStarted = onSessionStarted;\r\n    reco.sessionStopped = onSessionStopped;\r\n    // PhraseListGrammar allows for the customization of recognizer vocabulary.\r\n    // See https://docs.microsoft.com/azure/cognitive-services/speech-service/get-started-speech-to-text#improve-recognition-accuracy\r\n    if (competitorSuggestions) {\r\n        var phraseListGrammar = SpeechSDK.PhraseListGrammar.fromRecognizer(reco);\r\n        for (var index = 0; index < allCompetitors.length; index++) {\r\n            if (allCompetitors[index].sailNumber) {\r\n                phraseListGrammar.addPhrase(allCompetitors[index].sailNumber);\r\n            }\r\n            if (allCompetitors[index].alternativeSailNumber) {\r\n                phraseListGrammar.addPhrase(allCompetitors[index].alternativeSailNumber);\r\n            }\r\n            if (allCompetitors[index].name) {\r\n                phraseListGrammar.addPhrase(allCompetitors[index].name);\r\n            }\r\n        }\r\n        for (var index = 0; index < scoreCodes.length; index++) {\r\n            phraseListGrammar.addPhrase(scoreCodes[index].name);\r\n        }\r\n    }\r\n}\r\nfunction stopIfTimedOut() {\r\n    if (timeOfLastRecognized < Date.now() - (30000)) {\r\n        stopContinuousRecognition();\r\n    }\r\n}\r\nfunction doContinuousRecognition() {\r\n    resetUiForScenarioStart();\r\n    timeOfLastRecognized = Date.now();\r\n    if (timeOfLastToken < Date.now() - (5 * 60000)) {\r\n        RequestAuthorizationToken(doContinuousRecognition);\r\n        return;\r\n    }\r\n    var audioConfig = getAudioConfig();\r\n    var speechConfig = getSpeechConfig(SpeechSDK.SpeechConfig);\r\n    if (!speechConfig)\r\n        return;\r\n    // Create the SpeechRecognizer and set up common event handlers and PhraseList data\r\n    reco = new SpeechSDK.SpeechRecognizer(speechConfig, audioConfig);\r\n    applyCommonConfigurationTo(reco);\r\n    reco.startContinuousRecognitionAsync();\r\n}\r\nfunction stopContinuousRecognition() {\r\n    reco.stopContinuousRecognitionAsync(function () {\r\n        reco.close();\r\n        reco = undefined;\r\n    }, function (err) {\r\n        reco.close();\r\n        reco = undefined;\r\n    });\r\n}\r\nfunction setLastCompCode(scoreCode) {\r\n    $(\".select-code\").last().val(scoreCode);\r\n}\r\ninitialize();\r\n//# sourceMappingURL=raceEditor.js.map"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","jQuery","bootstrap","window","noCodeString","checkEnter","e","ev","event","test","srcElement","tagName","keyCode","which","charCode","loadSeriesOptions","clubId","date","val","data","seriesOptions","seriesSelect","selectedSeriesValues","empty","value","series","append","attr","id","toString","text","name","selectpicker","setSeries","loadFleet","fleetId","sel","document","getElementById","boatClassId","options","selectedIndex","getAttribute","length","getCompetitors","dateChanged","console","log","clearWeatherFields","weatherChanged","raceStateChanged","state","initials","icon","description","windSpeed","windGust","windDirection","temperature","humidity","cloudCoverPercent","compCreateSubmit","preventDefault","show","form","this","url","type","beforeSend","xhr","setRequestHeader","serialize","success","completeCompCreate","error","completeCompCreateFailed","hide","modal","moveUp","btn","target","resultItem","closest","prev","insertAfter","calculatePlaces","moveDown","next","insertBefore","deleteResult","compId","find","remove","updateButtonFooter","confirmDelete","compName","hideScoreButtonFooter","addNewCompetitorFromButton","HTMLButtonElement","competitorId","dataset","addNewCompetitor","allCompetitors","c","competitor","resultDiv","compListItem","cloneNode","setAttribute","span","getElementsByClassName","appendChild","createTextNode","sailNumber","alternativeSailNumber","style","display","deleteButtons","i","competitorIsInResults","animate","scrollTop","offset","top","initializeAutoComplete","resultItems","getElementsByTagName","scoreCount","len","origScore","shouldCompKeepScore","textContent","getCompetitorCode","removeAttribute","codepointsinput","shouldHaveManualEntry","comp","competitorSuggestions","forEach","language","region","authorizationToken","timeOfLastToken","timeOfLastRecognized","autoCompleteSetup","push","getSuggestions","autocomplete","dispose","lookup","onSelect","suggestion","autoSelectFirst","triggerSelectOnValidInput","noCache","codeText","getCompetitorCodePoints","codePoints","scoreCodes","filter","s","formula","RequestAuthorizationToken","continuation","speechInfoUrl","dataType","failureCount","token","userLanguage","Date","now","textStatus","errorThrown","SpeechSDK","phraseDiv","scenarioStartButton","scenarioStopButton","reco","onRecognized","sender","recognitionEventArgs","result","debug","ResultReason","reason","NoMatch","noMatchDetail","NoMatchDetails","fromResult","NoMatchReason","stopIfTimedOut","Canceled","cancelDetails","CancellationDetails","CancellationReason","Error","errorDetails","RecognizedSpeech","innerHTML","addPotentialMatches","normalizeText","onRecognizedResult","matchString","newResultString","startsWith","substr","trimLeft","scoreCode","sc","last","setLastCompCode","indexOf","fullText","replace","toUpperCase","onSessionStarted","sessionEventArgs","onSessionStopped","onCanceled","cancellationEventArgs","stopContinuousRecognition","doContinuousRecognition","audioConfig","AudioConfig","fromDefaultMicrophoneInput","speechConfig","sdkConfigType","fromAuthorizationToken","setProperty","SpeechServiceConnection_EndSilenceTimeoutMs","speechRecognitionLanguage","getSpeechConfig","SpeechConfig","recognizer","recognized","canceled","sessionStarted","sessionStopped","phraseListGrammar","PhraseListGrammar","fromRecognizer","index","addPhrase","applyCommonConfigurationTo","SpeechRecognizer","startContinuousRecognitionAsync","stopContinuousRecognitionAsync","close","undefined","err","addEventListener","onComplete","speechSdk","querySelector","onkeypress","change","setMinutes","getMinutes","getTimezoneOffset","toISOString","substring","on","click","submit","removeScoresFieldsFromForm","listIndex","input","createElement","addScoresFieldsToForm","initialize"],"sourceRoot":""}