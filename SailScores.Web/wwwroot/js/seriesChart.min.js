!function(t){var e={};function r(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=15)}({15:function(t,e,r){t.exports=r(16)},16:function(t,e){!function(){for(var t=600,e=document.getElementsByClassName("results-chart"),r=0;r<e.length;r++)a(e[r].dataset.seriesId,"#"+e[r].id);function a(e,r){var a,n,i="/series/chart?seriesId="+e;function o(t,e){var r=e.races.find(e=>e.id===t.raceId),a=e.races.filter(t=>t.date===r.date),n=a.findIndex(t=>t.id===r.id)+1;return new Date(new Date(r.date).getTime()+24*n*60*60*1e3/(a.length+1))}function l(e,r){var a=Math.max(...r.entries.filter(t=>t.raceId===e.raceId).map(t=>t.seriesPoints)),n=Math.min(...r.entries.filter(t=>t.raceId===e.raceId&&0!==t.seriesPoints).map(t=>t.seriesPoints)),i=(e.seriesPoints-n)/(a-n);return isNaN(i)&&(i=0),0===e.seriesPoints&&(i=1),30+i*(t-30-30)}function c(t){var e=d3.select(t.node().parentNode),r=parseInt(t.style("width")),a=parseInt(t.style("height")),n=r/a;function i(){var a=parseInt(e.style("width"));a<=100&&(a=r),t.attr("width",a),t.attr("height",Math.round(a/n))}t.attr("viewBox","0 0 "+r+" "+a).attr("preserveAspectRatio","xMinYMid").call(i),d3.select(window).on("resize."+e.attr("id"),i)}"undefined"!=typeof d3&&null!=d3&&d3.json(i).then((function(e){if(null===e)return;var i=e.races.map(t=>new Date(t.date));a=new Date(Math.min.apply(null,i)),(n=new Date(Math.max.apply(null,i))).setDate(n.getDate()+1);var s=d3.scaleTime().domain([a,n]).range([30,780]),d=d3.scaleOrdinal(d3.schemeDark2);t=16*e.competitors.length+60;var p=d3.select(r).attr("width",960).attr("height",t).call(c);function u(t){var e=t.competitorId||t.id;p.selectAll("path.compLine").attr("opacity",.4),p.selectAll("path[data-compId='"+e+"']").attr("stroke-width",4).attr("opacity",1),p.selectAll("g.legendEntry").attr("opacity",.4),p.selectAll("g.legendEntry[data-compId='"+e+"']").attr("opacity",1),p.selectAll("g.legendEntry[data-compId='"+e+"'] rect").attr("stroke",t=>d(t.id)),p.selectAll("circle").attr("opacity",.4),p.selectAll("circle[data-compId='"+e+"']").attr("opacity",1)}function f(e){p.selectAll("path.compLine").attr("stroke-width",1.5),p.selectAll("path.compLine").attr("opacity",1),p.selectAll("g.legendEntry rect").attr("stroke","none"),x.attr("opacity",0).attr("transform","translate(960,"+t+")"),p.selectAll("path.compLine").attr("opacity",1),p.selectAll("g.legendEntry").attr("opacity",1),p.selectAll("circle").attr("opacity",1)}var m=d3.select(r).selectAll("g.legendEntry").attr("transform","translate(810,32)").data(e.competitors).enter().append("g").attr("class","legendEntry").attr("data-compId",t=>t.id).attr("transform",(function(t,e){return"translate(810,"+(16*e+2+20)+")"})).attr("opacity",1).on("mouseover",u).on("mouseout",f);m.append("rect").attr("width",149).attr("height",16).attr("fill","none").attr("stroke-width",2),m.append("rect").attr("width",18).attr("height",12).attr("x",2).attr("y",2).style("fill",t=>d(t.id)).style("stroke-width",0),m.append("text").attr("x",22).attr("y",12).style("font-size","11px").text((function(t){return t.name}));var y=d3.axisTop().scale(s),h=d3.select("html").attr("lang").substring(0,2);(a-n<864e6||"en"!==h)&&(y=y.tickFormat(""));p.append("g").attr("id","xAxisG").attr("transform","translate(0,20)").call(y);var g=d3.line().x(t=>s(o(t,e))).y(t=>l(t,e));p.selectAll("path.compLine").data(e.competitors).enter().append("path").attr("class","compLine").attr("d",t=>g(e.entries.filter(e=>e.competitorId===t.id))).attr("fill","none").attr("opacity",1).attr("stroke",t=>d(t.id)).attr("stroke-width",1).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("data-compId",t=>t.id).on("mouseover",u).on("mouseout",f),p.selectAll("circle").data(e.entries).enter().append("circle").attr("r",3).attr("cy",t=>l(t,e)).attr("cx",t=>s(o(t,e))).attr("data-compId",t=>t.competitorId).attr("fill",t=>d(t.competitorId)).on("mouseover",(function(t){var r;x.attr("transform","translate("+s(o(t,e))+","+(l(t,e)-16)+")").attr("opacity",1).select("text").selectAll("*").remove(),x.select("text").append("tspan").text((r=t.raceId,e.races.find(t=>t.id===r).shortName)),x.select("text").append("tspan").attr("x",5).attr("y",27).text("Place: "+t.racePlace),x.select("text").append("tspan").attr("x",5).attr("y",43).text("Series points: "+t.seriesPoints),u(t)})).on("mouseout",f);var x=p.append("g").attr("opacity",0);x.append("rect").attr("width",120).attr("height",48).attr("fill","white").attr("fill-opacity",".7"),x.append("text").attr("x",5).attr("y",11).style("font-size","11px")}))}}()}});
//# sourceMappingURL=seriesChart.js.map